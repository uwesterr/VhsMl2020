<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 ML algorithms | Machine learning orientation</title>
  <meta name="description" content="A guide to machine learning" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 ML algorithms | Machine learning orientation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guide to machine learning" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 ML algorithms | Machine learning orientation" />
  
  <meta name="twitter:description" content="A guide to machine learning" />
  

<meta name="author" content="Uwe Sterr" />


<meta name="date" content="2020-02-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="machineLearningClasses.html"/>
<link rel="next" href="food-for-the-algorithms-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.11/datatables.js"></script>
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/uweBookdown.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Machine Learning orientation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#want-to-meet-ml-people-from-academia-and-industrie"><i class="fa fa-check"></i><b>1.1</b> Want to meet ML people from academia and industrie</a></li>
</ul></li>
<li class="part"><span><b>I Machine learning: Shall we?</b></span></li>
<li class="chapter" data-level="2" data-path="whatML.html"><a href="whatML.html"><i class="fa fa-check"></i><b>2</b> What is machine learning?</a><ul>
<li class="chapter" data-level="2.1" data-path="whatML.html"><a href="whatML.html#what-is-intelligence"><i class="fa fa-check"></i><b>2.1</b> What is intelligence?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="whatML.html"><a href="whatML.html#definition-of-artificial-intelligence-sub-domains"><i class="fa fa-check"></i><b>2.1.1</b> Definition of artificial intelligence sub domains</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="whatML.html"><a href="whatML.html#is-ai-smarter-than-humans"><i class="fa fa-check"></i><b>2.2</b> Is AI smarter than humans?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="whatML.html"><a href="whatML.html#thinking-fast-and-slow-kahneman2011thinking"><i class="fa fa-check"></i><b>2.2.1</b> Thinking, fast and slow <span class="citation">(Kahneman <span>2011</span>)</span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="whatML.html"><a href="whatML.html#comparisons-between-ai-and-humans"><i class="fa fa-check"></i><b>2.3</b> Comparisons between AI and humans</a><ul>
<li class="chapter" data-level="2.3.1" data-path="whatML.html"><a href="whatML.html#breast-cancer-detection"><i class="fa fa-check"></i><b>2.3.1</b> Breast cancer detection</a></li>
<li class="chapter" data-level="2.3.2" data-path="whatML.html"><a href="whatML.html#working-together-lung-cancer-detection"><i class="fa fa-check"></i><b>2.3.2</b> Working together: Lung cancer detection</a></li>
<li class="chapter" data-level="2.3.3" data-path="whatML.html"><a href="whatML.html#imagenet-large-scale-visual-recognition-challenge-ilsvrc"><i class="fa fa-check"></i><b>2.3.3</b> ImageNet Large Scale Visual Recognition Challenge (ILSVRC)</a></li>
<li class="chapter" data-level="2.3.4" data-path="whatML.html"><a href="whatML.html#alphago-zero"><i class="fa fa-check"></i><b>2.3.4</b> AlphaGo Zero</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="whatML.html"><a href="whatML.html#ml-models-with-bias"><i class="fa fa-check"></i><b>2.4</b> ML models with bias</a></li>
<li class="chapter" data-level="2.5" data-path="whatML.html"><a href="whatML.html#attacks-on-ml-models"><i class="fa fa-check"></i><b>2.5</b> Attacks on ML models</a><ul>
<li class="chapter" data-level="2.5.1" data-path="whatML.html"><a href="whatML.html#adding-noise-to-image-leads-to-misclassification"><i class="fa fa-check"></i><b>2.5.1</b> Adding noise to image leads to misclassification</a></li>
<li class="chapter" data-level="2.5.2" data-path="whatML.html"><a href="whatML.html#but-what-about-attacks-on-human-perception"><i class="fa fa-check"></i><b>2.5.2</b> But what about attacks on human perception?</a></li>
<li class="chapter" data-level="" data-path="whatML.html"><a href="whatML.html#is-this-a-picture-of-a-real-person"><i class="fa fa-check"></i>Is this a picture of a real person?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="outlook.html"><a href="outlook.html"><i class="fa fa-check"></i><b>3</b> Outlook</a><ul>
<li class="chapter" data-level="3.1" data-path="outlook.html"><a href="outlook.html#development-of-life"><i class="fa fa-check"></i><b>3.1</b> Development of life</a><ul>
<li class="chapter" data-level="3.1.1" data-path="outlook.html"><a href="outlook.html#when-will-superhuman-ai-come-and-will-it-be-good"><i class="fa fa-check"></i><b>3.1.1</b> When will superhuman AI come, and will it be good?</a></li>
<li class="chapter" data-level="3.1.2" data-path="outlook.html"><a href="outlook.html#ai-aftermath-scenario"><i class="fa fa-check"></i><b>3.1.2</b> AI aftermath scenario</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="outlook.html"><a href="outlook.html#data-religion-dataism"><i class="fa fa-check"></i><b>3.2</b> Data religion: Dataism</a></li>
<li class="chapter" data-level="3.3" data-path="outlook.html"><a href="outlook.html#career-oxford-seeks-ai-ethics-professor"><i class="fa fa-check"></i><b>3.3</b> Career: Oxford seeks AI ethics professor</a></li>
</ul></li>
<li class="part"><span><b>II Machine learning fundamentals</b></span></li>
<li class="chapter" data-level="4" data-path="MachineLearningFundamentals.html"><a href="MachineLearningFundamentals.html"><i class="fa fa-check"></i><b>4</b> Machine learning fundamentals</a></li>
<li class="chapter" data-level="5" data-path="ml-project-process.html"><a href="ml-project-process.html"><i class="fa fa-check"></i><b>5</b> ML project process</a><ul>
<li class="chapter" data-level="5.1" data-path="ml-project-process.html"><a href="ml-project-process.html#identify-ml-suited-to-fulfill-need"><i class="fa fa-check"></i><b>5.1</b> Identify ML suited to fulfill need</a></li>
<li class="chapter" data-level="5.2" data-path="ml-project-process.html"><a href="ml-project-process.html#gather-data-tbc"><i class="fa fa-check"></i><b>5.2</b> Gather data TBC</a><ul>
<li class="chapter" data-level="5.2.1" data-path="ml-project-process.html"><a href="ml-project-process.html#how-much-data-is-necessary"><i class="fa fa-check"></i><b>5.2.1</b> How much data is necessary?</a></li>
<li class="chapter" data-level="5.2.2" data-path="ml-project-process.html"><a href="ml-project-process.html#which-data-is-useful"><i class="fa fa-check"></i><b>5.2.2</b> Which data is useful?</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ml-project-process.html"><a href="ml-project-process.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>5.3</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="5.4" data-path="ml-project-process.html"><a href="ml-project-process.html#qunatitiave-anaylsis"><i class="fa fa-check"></i><b>5.4</b> Qunatitiave anaylsis</a></li>
<li class="chapter" data-level="5.5" data-path="ml-project-process.html"><a href="ml-project-process.html#feature-engineering"><i class="fa fa-check"></i><b>5.5</b> Feature engineering</a><ul>
<li class="chapter" data-level="5.5.1" data-path="ml-project-process.html"><a href="ml-project-process.html#featureImportance"><i class="fa fa-check"></i><b>5.5.1</b> Feature importance</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="ml-project-process.html"><a href="ml-project-process.html#model-fit"><i class="fa fa-check"></i><b>5.6</b> Model fit</a></li>
<li class="chapter" data-level="5.7" data-path="ml-project-process.html"><a href="ml-project-process.html#model-tuning"><i class="fa fa-check"></i><b>5.7</b> Model tuning</a></li>
<li class="chapter" data-level="" data-path="ml-project-process.html"><a href="ml-project-process.html#after-data-gathering-iteration-is-trump"><i class="fa fa-check"></i>After data gathering iteration is trump</a></li>
<li class="chapter" data-level="5.8" data-path="ml-project-process.html"><a href="ml-project-process.html#feature-engineering-1"><i class="fa fa-check"></i><b>5.8</b> Feature engineering</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machineLearningClasses.html"><a href="machineLearningClasses.html"><i class="fa fa-check"></i><b>6</b> Machine learning classes</a><ul>
<li class="chapter" data-level="6.1" data-path="machineLearningClasses.html"><a href="machineLearningClasses.html#supervised-learning"><i class="fa fa-check"></i><b>6.1</b> Supervised learning</a></li>
<li class="chapter" data-level="6.2" data-path="machineLearningClasses.html"><a href="machineLearningClasses.html#unsupervised-learning"><i class="fa fa-check"></i><b>6.2</b> Unsupervised learning</a></li>
<li class="chapter" data-level="6.3" data-path="machineLearningClasses.html"><a href="machineLearningClasses.html#reinforcement-learning"><i class="fa fa-check"></i><b>6.3</b> Reinforcement learning</a><ul>
<li class="chapter" data-level="6.3.1" data-path="machineLearningClasses.html"><a href="machineLearningClasses.html#elements-of-reinforcement-learning"><i class="fa fa-check"></i><b>6.3.1</b> Elements of reinforcement learning</a></li>
<li class="chapter" data-level="6.3.2" data-path="machineLearningClasses.html"><a href="machineLearningClasses.html#rl-algorithms"><i class="fa fa-check"></i><b>6.3.2</b> RL algorithms</a></li>
<li class="chapter" data-level="6.3.3" data-path="machineLearningClasses.html"><a href="machineLearningClasses.html#example-self-driving-car-mit"><i class="fa fa-check"></i><b>6.3.3</b> Example self driving car MIT</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html"><i class="fa fa-check"></i><b>7</b> ML algorithms</a><ul>
<li class="chapter" data-level="7.1" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#MlAlgoLinReg"><i class="fa fa-check"></i><b>7.1</b> Linear regression TBD</a><ul>
<li class="chapter" data-level="7.1.1" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#example-for-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Example for linear regression</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#MlAlgoLogReg"><i class="fa fa-check"></i><b>7.2</b> Logistic regression</a><ul>
<li class="chapter" data-level="7.2.1" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#python-example-logistic-regression"><i class="fa fa-check"></i><b>7.2.1</b> Python example logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#MlAlgoTrees"><i class="fa fa-check"></i><b>7.3</b> Tree based methods TBD</a><ul>
<li class="chapter" data-level="7.3.1" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#splitting-metrics"><i class="fa fa-check"></i><b>7.3.1</b> Splitting metrics</a></li>
<li class="chapter" data-level="7.3.2" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#ensembles"><i class="fa fa-check"></i><b>7.3.2</b> Ensembles</a></li>
<li class="chapter" data-level="7.3.3" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#MlAlgoTreesRandomForest"><i class="fa fa-check"></i><b>7.3.3</b> Random forest TBD</a></li>
<li class="chapter" data-level="7.3.4" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#MlAlgoTreesGBM"><i class="fa fa-check"></i><b>7.3.4</b> Boosted trees TBD</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#MlAlgoSvm"><i class="fa fa-check"></i><b>7.4</b> Support Vector Machine (SVM) TBD</a><ul>
<li class="chapter" data-level="7.4.1" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#kernels"><i class="fa fa-check"></i><b>7.4.1</b> Kernels</a></li>
<li class="chapter" data-level="7.4.2" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#python-example-for-svm"><i class="fa fa-check"></i><b>7.4.2</b> Python example for SVM</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#neural-networks"><i class="fa fa-check"></i><b>7.5</b> Neural networks</a><ul>
<li class="chapter" data-level="7.5.1" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#convolutional-neural-network-cnn-tbd"><i class="fa fa-check"></i><b>7.5.1</b> Convolutional Neural Network (CNN) TBD</a></li>
<li class="chapter" data-level="7.5.2" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#rnn-tbd"><i class="fa fa-check"></i><b>7.5.2</b> RNN TBD</a></li>
<li class="chapter" data-level="7.5.3" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#gans"><i class="fa fa-check"></i><b>7.5.3</b> GANs</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#a-gentle-introduction-to-cyclegan-for-image-translation"><i class="fa fa-check"></i><b>7.6</b> A Gentle Introduction to CycleGAN for Image Translation</a><ul>
<li class="chapter" data-level="7.6.1" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#examples-for-gans"><i class="fa fa-check"></i><b>7.6.1</b> Examples for GANs</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#software-that-can-generate-photos-from-paintings-turn-horses-into-zebras-perform-style-transfer-and-more."><i class="fa fa-check"></i><b>7.7</b> Software that can generate photos from paintings, turn horses into zebras, perform style transfer, and more.</a></li>
<li class="chapter" data-level="7.8" data-path="MlAlgorithm.html"><a href="MlAlgorithm.html#transformers-tbd"><i class="fa fa-check"></i><b>7.8</b> Transformers TBD</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="food-for-the-algorithms-data.html"><a href="food-for-the-algorithms-data.html"><i class="fa fa-check"></i><b>8</b> Food for the algorithms: Data</a><ul>
<li class="chapter" data-level="8.1" data-path="food-for-the-algorithms-data.html"><a href="food-for-the-algorithms-data.html#nlp"><i class="fa fa-check"></i><b>8.1</b> NLP</a></li>
<li class="chapter" data-level="8.2" data-path="food-for-the-algorithms-data.html"><a href="food-for-the-algorithms-data.html#discovering-millions-of-datasets-on-the-web"><i class="fa fa-check"></i><b>8.2</b> Discovering millions of datasets on the web</a></li>
</ul></li>
<li class="part"><span><b>III Explainable ML</b></span></li>
<li class="chapter" data-level="9" data-path="ExplainableMl.html"><a href="ExplainableMl.html"><i class="fa fa-check"></i><b>9</b> Explainable ML tbd</a><ul>
<li class="chapter" data-level="9.1" data-path="ExplainableMl.html"><a href="ExplainableMl.html#lime-tbd"><i class="fa fa-check"></i><b>9.1</b> Lime tbd</a></li>
<li class="chapter" data-level="9.2" data-path="ExplainableMl.html"><a href="ExplainableMl.html#alibi-tbd"><i class="fa fa-check"></i><b>9.2</b> alibi tbd</a></li>
<li class="chapter" data-level="9.3" data-path="ExplainableMl.html"><a href="ExplainableMl.html#tf-explain-tbd"><i class="fa fa-check"></i><b>9.3</b> tf-explain tbd</a></li>
<li class="chapter" data-level="9.4" data-path="ExplainableMl.html"><a href="ExplainableMl.html#keras-salient-object-visualization"><i class="fa fa-check"></i><b>9.4</b> keras-salient-object-visualization</a><ul>
<li class="chapter" data-level="9.4.1" data-path="ExplainableMl.html"><a href="ExplainableMl.html#explaining-how-a-deep-neural-network-trained-with-end-to-end-learning-steers-a-car"><i class="fa fa-check"></i><b>9.4.1</b> Explaining How a Deep Neural Network Trained with End-to-End Learning Steers a Car</a></li>
<li class="chapter" data-level="9.4.2" data-path="ExplainableMl.html"><a href="ExplainableMl.html#visualbackprop-efficient-visualization-of-cnns"><i class="fa fa-check"></i><b>9.4.2</b> VisualBackProp: efficient visualization of CNNs</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV ML online resources</b></span></li>
<li class="chapter" data-level="10" data-path="MlResources.html"><a href="MlResources.html"><i class="fa fa-check"></i><b>10</b> ML online resources</a><ul>
<li class="chapter" data-level="10.1" data-path="MlResources.html"><a href="MlResources.html#in-depth-introduction-to-machine-learning-in-15-hours-of-expert-videos"><i class="fa fa-check"></i><b>10.1</b> In-depth introduction to machine learning in 15 hours of expert videos</a><ul>
<li class="chapter" data-level="10.1.1" data-path="MlResources.html"><a href="MlResources.html#an-introduction-to-statistical-learning"><i class="fa fa-check"></i><b>10.1.1</b> An Introduction to Statistical Learning</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="MlResources.html"><a href="MlResources.html#the-learning-machine"><i class="fa fa-check"></i><b>10.2</b> The learning machine</a></li>
<li class="chapter" data-level="10.3" data-path="MlResources.html"><a href="MlResources.html#deepai-the-front-page-of-a.i."><i class="fa fa-check"></i><b>10.3</b> DeepAI: The front page of A.I.</a></li>
<li class="chapter" data-level="10.4" data-path="MlResources.html"><a href="MlResources.html#tensorflow-tutorials"><i class="fa fa-check"></i><b>10.4</b> TensorFlow tutorials</a><ul>
<li class="chapter" data-level="10.4.1" data-path="MlResources.html"><a href="MlResources.html#mit-6.s191-introduction-to-deep-learning"><i class="fa fa-check"></i><b>10.4.1</b> MIT 6.S191 Introduction to Deep Learning</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="MlResources.html"><a href="MlResources.html#fastai"><i class="fa fa-check"></i><b>10.5</b> FastAI</a></li>
<li class="chapter" data-level="10.6" data-path="MlResources.html"><a href="MlResources.html#embedding-projector"><i class="fa fa-check"></i><b>10.6</b> Embedding Projector</a></li>
<li class="chapter" data-level="10.7" data-path="MlResources.html"><a href="MlResources.html#tensorboard-playground"><i class="fa fa-check"></i><b>10.7</b> Tensorboard playground</a></li>
</ul></li>
<li class="part"><span><b>V Examples from Kaggle</b></span></li>
<li class="chapter" data-level="11" data-path="KaggleExamples.html"><a href="KaggleExamples.html"><i class="fa fa-check"></i><b>11</b> Examples in Kaggle</a></li>
<li class="chapter" data-level="12" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html"><i class="fa fa-check"></i><b>12</b> Melbourne University AES/MathWorks/NIH Seizure Prediction</a><ul>
<li class="chapter" data-level="12.1" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#winning-solution-1st"><i class="fa fa-check"></i><b>12.1</b> Winning solution (1st)</a><ul>
<li class="chapter" data-level="12.1.1" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#alex-gilberto-models"><i class="fa fa-check"></i><b>12.1.1</b> Alex / Gilberto models</a></li>
<li class="chapter" data-level="12.1.2" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#feng-models"><i class="fa fa-check"></i><b>12.1.2</b> Feng models</a></li>
<li class="chapter" data-level="12.1.3" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#andriy-models"><i class="fa fa-check"></i><b>12.1.3</b> Andriy models</a></li>
<li class="chapter" data-level="12.1.4" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#code-on-github"><i class="fa fa-check"></i><b>12.1.4</b> Code on GitHub</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#solution4th-place"><i class="fa fa-check"></i><b>12.2</b> Solution(4th place)</a><ul>
<li class="chapter" data-level="12.2.1" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#pre-processing-6"><i class="fa fa-check"></i><b>12.2.1</b> Pre-processing</a></li>
<li class="chapter" data-level="12.2.2" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#features-3"><i class="fa fa-check"></i><b>12.2.2</b> Features</a></li>
<li class="chapter" data-level="12.2.3" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#model"><i class="fa fa-check"></i><b>12.2.3</b> Model</a></li>
<li class="chapter" data-level="12.2.4" data-path="melbourne-university-aesmathworksnih-seizure-prediction.html"><a href="melbourne-university-aesmathworksnih-seizure-prediction.html#github-code"><i class="fa fa-check"></i><b>12.2.4</b> GitHub code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html"><i class="fa fa-check"></i><b>13</b> Bosch Production Line Performance</a><ul>
<li class="chapter" data-level="13.1" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#st-place-solution"><i class="fa fa-check"></i><b>13.1</b> 1st place solution</a><ul>
<li class="chapter" data-level="13.1.1" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#data-exploration"><i class="fa fa-check"></i><b>13.1.1</b> Data exploration</a></li>
<li class="chapter" data-level="13.1.2" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#hand-crafted-features"><i class="fa fa-check"></i><b>13.1.2</b> Hand crafted features</a></li>
<li class="chapter" data-level="13.1.3" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#hardware"><i class="fa fa-check"></i><b>13.1.3</b> Hardware</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#rd-place-solution-tbd"><i class="fa fa-check"></i><b>13.2</b> 3rd place solution TBD</a></li>
<li class="chapter" data-level="13.3" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#th-place-solution-with-github"><i class="fa fa-check"></i><b>13.3</b> 8th place solution with GitHub</a><ul>
<li class="chapter" data-level="13.3.1" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#overall-architecture"><i class="fa fa-check"></i><b>13.3.1</b> Overall architecture</a></li>
<li class="chapter" data-level="13.3.2" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#input-data-sets"><i class="fa fa-check"></i><b>13.3.2</b> Input data sets</a></li>
<li class="chapter" data-level="13.3.3" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#ensembling"><i class="fa fa-check"></i><b>13.3.3</b> Ensembling</a></li>
<li class="chapter" data-level="13.3.4" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#features-4"><i class="fa fa-check"></i><b>13.3.4</b> Features</a></li>
<li class="chapter" data-level="13.3.5" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#validation-method"><i class="fa fa-check"></i><b>13.3.5</b> Validation method</a></li>
<li class="chapter" data-level="13.3.6" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#software-1"><i class="fa fa-check"></i><b>13.3.6</b> Software</a></li>
<li class="chapter" data-level="13.3.7" data-path="bosch-production-line-performance.html"><a href="bosch-production-line-performance.html#code-on-github-1"><i class="fa fa-check"></i><b>13.3.7</b> Code on GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="corporación-favorita-grocery-sales-forecasting.html"><a href="corporación-favorita-grocery-sales-forecasting.html"><i class="fa fa-check"></i><b>14</b> Corporación Favorita Grocery Sales Forecasting</a><ul>
<li class="chapter" data-level="14.1" data-path="corporación-favorita-grocery-sales-forecasting.html"><a href="corporación-favorita-grocery-sales-forecasting.html#st-place-solution-1"><i class="fa fa-check"></i><b>14.1</b> 1st place solution</a></li>
<li class="chapter" data-level="14.2" data-path="corporación-favorita-grocery-sales-forecasting.html"><a href="corporación-favorita-grocery-sales-forecasting.html#th-place-solution-overview"><i class="fa fa-check"></i><b>14.2</b> 4th-Place Solution Overview</a></li>
<li class="chapter" data-level="14.3" data-path="corporación-favorita-grocery-sales-forecasting.html"><a href="corporación-favorita-grocery-sales-forecasting.html#th-place-solution"><i class="fa fa-check"></i><b>14.3</b> 5th Place Solution</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="severstal-steel-defect-detection.html"><a href="severstal-steel-defect-detection.html"><i class="fa fa-check"></i><b>15</b> Severstal: Steel Defect Detection</a></li>
<li class="chapter" data-level="16" data-path="lyft-3d-object-detection-for-autonomous-vehicles.html"><a href="lyft-3d-object-detection-for-autonomous-vehicles.html"><i class="fa fa-check"></i><b>16</b> Lyft 3D Object Detection for Autonomous Vehicles</a><ul>
<li class="chapter" data-level="16.1" data-path="lyft-3d-object-detection-for-autonomous-vehicles.html"><a href="lyft-3d-object-detection-for-autonomous-vehicles.html#rd-place-solution"><i class="fa fa-check"></i><b>16.1</b> 3rd place solution</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="aptos-2019-blindness-detection.html"><a href="aptos-2019-blindness-detection.html"><i class="fa fa-check"></i><b>17</b> APTOS 2019 Blindness Detection</a><ul>
<li class="chapter" data-level="17.1" data-path="aptos-2019-blindness-detection.html"><a href="aptos-2019-blindness-detection.html#st-place-solution-summary"><i class="fa fa-check"></i><b>17.1</b> 1st place solution summary</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html"><i class="fa fa-check"></i><b>18</b> Predicting Molecular Properties</a><ul>
<li class="chapter" data-level="18.1" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#solution---hybrid"><i class="fa fa-check"></i><b>18.1</b> #1 Solution - hybrid</a><ul>
<li class="chapter" data-level="18.1.1" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#overall-architecture-1"><i class="fa fa-check"></i><b>18.1.1</b> Overall architecture</a></li>
<li class="chapter" data-level="18.1.2" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#ensembling-1"><i class="fa fa-check"></i><b>18.1.2</b> Ensembling</a></li>
<li class="chapter" data-level="18.1.3" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#hardware-1"><i class="fa fa-check"></i><b>18.1.3</b> Hardware</a></li>
<li class="chapter" data-level="18.1.4" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#software-2"><i class="fa fa-check"></i><b>18.1.4</b> Software</a></li>
<li class="chapter" data-level="18.1.5" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#code-on-github-2"><i class="fa fa-check"></i><b>18.1.5</b> Code on GitHub</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#solution-quantum-uncertainty"><i class="fa fa-check"></i><b>18.2</b> #2 solution 🤖 Quantum Uncertainty 🤖</a><ul>
<li class="chapter" data-level="18.2.1" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#overall-architecture-2"><i class="fa fa-check"></i><b>18.2.1</b> Overall architecture</a></li>
<li class="chapter" data-level="18.2.2" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#input-features-and-embeddings-1"><i class="fa fa-check"></i><b>18.2.2</b> Input features and embeddings</a></li>
<li class="chapter" data-level="18.2.3" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#data-augmentation"><i class="fa fa-check"></i><b>18.2.3</b> Data augmentation</a></li>
<li class="chapter" data-level="18.2.4" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#ensembling-2"><i class="fa fa-check"></i><b>18.2.4</b> Ensembling</a></li>
<li class="chapter" data-level="18.2.5" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#hardware-2"><i class="fa fa-check"></i><b>18.2.5</b> Hardware</a></li>
<li class="chapter" data-level="18.2.6" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#software-3"><i class="fa fa-check"></i><b>18.2.6</b> Software</a></li>
<li class="chapter" data-level="18.2.7" data-path="predicting-molecular-properties.html"><a href="predicting-molecular-properties.html#code-on-github-3"><i class="fa fa-check"></i><b>18.2.7</b> Code on GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="local-examples.html"><a href="local-examples.html"><i class="fa fa-check"></i><b>19</b> Local examples</a><ul>
<li class="chapter" data-level="19.1" data-path="local-examples.html"><a href="local-examples.html#university-suttgart-indoor-ortung-mit-mobilfunk"><i class="fa fa-check"></i><b>19.1</b> University Suttgart: Indoor-Ortung mit Mobilfunk</a></li>
<li class="chapter" data-level="19.2" data-path="local-examples.html"><a href="local-examples.html#bionic-learning-network"><i class="fa fa-check"></i><b>19.2</b> Bionic Learning Network</a></li>
</ul></li>
<li class="part"><span><b>VI Real world example</b></span></li>
<li class="chapter" data-level="20" data-path="RealWorld.html"><a href="RealWorld.html"><i class="fa fa-check"></i><b>20</b> Real world example</a><ul>
<li class="chapter" data-level="20.1" data-path="RealWorld.html"><a href="RealWorld.html#subject-of-the-project"><i class="fa fa-check"></i><b>20.1</b> Subject of the project</a><ul>
<li class="chapter" data-level="" data-path="RealWorld.html"><a href="RealWorld.html#depending-from-where-you-were-looking"><i class="fa fa-check"></i>Depending from where you were looking:</a></li>
<li class="chapter" data-level="" data-path="RealWorld.html"><a href="RealWorld.html#looking-from-the-perspective-of-machine-learning-expert"><i class="fa fa-check"></i>Looking from the perspective of machine learning expert</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="RealWorld.html"><a href="RealWorld.html#project-phases"><i class="fa fa-check"></i><b>20.2</b> Project phases</a><ul>
<li class="chapter" data-level="" data-path="RealWorld.html"><a href="RealWorld.html#the-main-project-phases-are"><i class="fa fa-check"></i>The main project phases are:</a></li>
<li class="chapter" data-level="" data-path="RealWorld.html"><a href="RealWorld.html#after-data-gathering-iteration-is-trump-1"><i class="fa fa-check"></i>After data gathering iteration is trump</a></li>
<li class="chapter" data-level="20.2.1" data-path="RealWorld.html"><a href="RealWorld.html#feature-engineering-2"><i class="fa fa-check"></i><b>20.2.1</b> Feature engineering</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="RealWorld.html"><a href="RealWorld.html#algorithm-selection"><i class="fa fa-check"></i><b>20.3</b> Algorithm selection</a><ul>
<li class="chapter" data-level="20.3.1" data-path="RealWorld.html"><a href="RealWorld.html#logistic-regression"><i class="fa fa-check"></i><b>20.3.1</b> Logistic regression</a></li>
<li class="chapter" data-level="20.3.2" data-path="RealWorld.html"><a href="RealWorld.html#tree-based-tbd"><i class="fa fa-check"></i><b>20.3.2</b> Tree based TBD</a></li>
<li class="chapter" data-level="20.3.3" data-path="RealWorld.html"><a href="RealWorld.html#support-vector-machine-svm-tbd"><i class="fa fa-check"></i><b>20.3.3</b> Support Vector Machine (SVM) TBD</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="RealWorld.html"><a href="RealWorld.html#performance-measurement"><i class="fa fa-check"></i><b>20.4</b> Performance measurement</a><ul>
<li class="chapter" data-level="20.4.1" data-path="RealWorld.html"><a href="RealWorld.html#sensitivity-and-specificity"><i class="fa fa-check"></i><b>20.4.1</b> Sensitivity and specificity</a></li>
<li class="chapter" data-level="20.4.2" data-path="RealWorld.html"><a href="RealWorld.html#receiver-operating-characteristic-roc"><i class="fa fa-check"></i><b>20.4.2</b> Receiver operating characteristic (ROC)</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="RealWorld.html"><a href="RealWorld.html#confusion-matrix-and-roc-for-pulse"><i class="fa fa-check"></i><b>20.5</b> Confusion matrix and ROC for pulse</a><ul>
<li class="chapter" data-level="20.5.1" data-path="RealWorld.html"><a href="RealWorld.html#r-plots"><i class="fa fa-check"></i><b>20.5.1</b> R Plots</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="RealWorld.html"><a href="RealWorld.html#create-augmented-labeled-data"><i class="fa fa-check"></i><b>20.6</b> Create augmented labeled data</a><ul>
<li class="chapter" data-level="20.6.1" data-path="RealWorld.html"><a href="RealWorld.html#features-of-time-signals"><i class="fa fa-check"></i><b>20.6.1</b> Features of time signals</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="RealWorld.html"><a href="RealWorld.html#features-generated"><i class="fa fa-check"></i><b>20.7</b> Features generated</a><ul>
<li class="chapter" data-level="20.7.1" data-path="RealWorld.html"><a href="RealWorld.html#analysis-of-generated-features"><i class="fa fa-check"></i><b>20.7.1</b> Analysis of generated features</a></li>
<li class="chapter" data-level="20.7.2" data-path="RealWorld.html"><a href="RealWorld.html#dynamic-time-warp-dtw-for-signal"><i class="fa fa-check"></i><b>20.7.2</b> Dynamic time warp (DTW) for signal</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="RealWorld.html"><a href="RealWorld.html#algorithm"><i class="fa fa-check"></i><b>20.8</b> Algorithm</a></li>
<li class="chapter" data-level="20.9" data-path="RealWorld.html"><a href="RealWorld.html#confusion-matrix-results-logistic-regression-for-measured-data"><i class="fa fa-check"></i><b>20.9</b> Confusion matrix results logistic regression for measured data</a><ul>
<li class="chapter" data-level="20.9.1" data-path="RealWorld.html"><a href="RealWorld.html#roc-results-for-measured-data"><i class="fa fa-check"></i><b>20.9.1</b> ROC results for measured data</a></li>
</ul></li>
<li class="chapter" data-level="20.10" data-path="RealWorld.html"><a href="RealWorld.html#several-algorithms-results-for-snr-18db"><i class="fa fa-check"></i><b>20.10</b> Several algorithms results for SNR = 18dB</a><ul>
<li class="chapter" data-level="20.10.1" data-path="RealWorld.html"><a href="RealWorld.html#roc-results-for-snr-18db"><i class="fa fa-check"></i><b>20.10.1</b> ROC results for SNR 18dB</a></li>
</ul></li>
<li class="chapter" data-level="20.11" data-path="RealWorld.html"><a href="RealWorld.html#compare-models-for-snr-18db"><i class="fa fa-check"></i><b>20.11</b> Compare models for SNR = 18dB</a></li>
<li class="chapter" data-level="20.12" data-path="RealWorld.html"><a href="RealWorld.html#optimize-ml-hyper-parameter"><i class="fa fa-check"></i><b>20.12</b> Optimize ML hyper parameter</a></li>
</ul></li>
<li class="part"><span><b>VII Cloud-based machine learning</b></span></li>
<li class="chapter" data-level="21" data-path="CloudBasedMl.html"><a href="CloudBasedMl.html"><i class="fa fa-check"></i><b>21</b> Cloud-based machine learning</a></li>
<li class="part"><span><b>VIII Kaggle Survey</b></span></li>
<li class="chapter" data-level="22" data-path="KaggleSurvey.html"><a href="KaggleSurvey.html"><i class="fa fa-check"></i><b>22</b> Kaggle survey introduction</a><ul>
<li class="chapter" data-level="22.1" data-path="KaggleSurvey.html"><a href="KaggleSurvey.html#kaggle-survey-details"><i class="fa fa-check"></i><b>22.1</b> Kaggle survey details</a></li>
<li class="chapter" data-level="22.2" data-path="KaggleSurvey.html"><a href="KaggleSurvey.html#purpose"><i class="fa fa-check"></i><b>22.2</b> Purpose</a></li>
<li class="chapter" data-level="22.3" data-path="KaggleSurvey.html"><a href="KaggleSurvey.html#navigation-and-handling"><i class="fa fa-check"></i><b>22.3</b> Navigation and handling</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>23</b> Results</a><ul>
<li class="chapter" data-level="23.1" data-path="results.html"><a href="results.html#survey-participants-education-level"><i class="fa fa-check"></i><b>23.1</b> Survey participants education level</a></li>
<li class="chapter" data-level="23.2" data-path="results.html"><a href="results.html#who-uses-which-algorithm"><i class="fa fa-check"></i><b>23.2</b> Who uses which algorithm</a></li>
<li class="chapter" data-level="23.3" data-path="results.html"><a href="results.html#machine-learning-experience-and-algorithms"><i class="fa fa-check"></i><b>23.3</b> Machine learning experience and algorithms</a></li>
<li class="chapter" data-level="23.4" data-path="results.html"><a href="results.html#experience-and-new-algorithms"><i class="fa fa-check"></i><b>23.4</b> Experience and new algorithms</a></li>
<li class="chapter" data-level="23.5" data-path="results.html"><a href="results.html#role-of-participants"><i class="fa fa-check"></i><b>23.5</b> Role of participants</a></li>
<li class="chapter" data-level="23.6" data-path="results.html"><a href="results.html#company-size"><i class="fa fa-check"></i><b>23.6</b> Company size</a></li>
<li class="chapter" data-level="23.7" data-path="results.html"><a href="results.html#company-incorporation-of-machine-learning"><i class="fa fa-check"></i><b>23.7</b> Company incorporation of machine learning</a></li>
<li class="chapter" data-level="23.8" data-path="results.html"><a href="results.html#favourite-media-sources-on-data-science-topics"><i class="fa fa-check"></i><b>23.8</b> Favourite media sources on data science topics</a></li>
<li class="chapter" data-level="23.9" data-path="results.html"><a href="results.html#favourite-online-course-platform"><i class="fa fa-check"></i><b>23.9</b> Favourite online course platform</a></li>
<li class="chapter" data-level="23.10" data-path="results.html"><a href="results.html#favourite-data-analyzing-tool"><i class="fa fa-check"></i><b>23.10</b> Favourite data analyzing tool</a></li>
<li class="chapter" data-level="23.11" data-path="results.html"><a href="results.html#experience-in-data-analysis-coding"><i class="fa fa-check"></i><b>23.11</b> Experience in data analysis coding</a></li>
<li class="chapter" data-level="23.12" data-path="results.html"><a href="results.html#favourite-integrated-development-environments-ides"><i class="fa fa-check"></i><b>23.12</b> Favourite integrated development environments (IDE’s)</a></li>
<li class="chapter" data-level="23.13" data-path="results.html"><a href="results.html#favourite-hosted-notebook-products"><i class="fa fa-check"></i><b>23.13</b> Favourite hosted notebook products</a></li>
<li class="chapter" data-level="23.14" data-path="results.html"><a href="results.html#favourite-programming-languages"><i class="fa fa-check"></i><b>23.14</b> Favourite programming languages</a></li>
<li class="chapter" data-level="23.15" data-path="results.html"><a href="results.html#recommended-entry-programming-language"><i class="fa fa-check"></i><b>23.15</b> Recommended entry programming language</a></li>
<li class="chapter" data-level="23.16" data-path="results.html"><a href="results.html#favourite-data-visualization-libraries-or-tools"><i class="fa fa-check"></i><b>23.16</b> Favourite data visualization libraries or tools</a></li>
<li class="chapter" data-level="23.17" data-path="results.html"><a href="results.html#favourite-specialized-hardware"><i class="fa fa-check"></i><b>23.17</b> Favourite specialized hardware</a></li>
<li class="chapter" data-level="23.18" data-path="results.html"><a href="results.html#favourite-machine-learning-frameworks"><i class="fa fa-check"></i><b>23.18</b> Favourite machine learning frameworks</a></li>
<li class="chapter" data-level="23.19" data-path="results.html"><a href="results.html#favourite-cloud-computing-platforms"><i class="fa fa-check"></i><b>23.19</b> Favourite cloud computing platforms</a></li>
<li class="chapter" data-level="23.20" data-path="results.html"><a href="results.html#favourite-big-data-analytics-products"><i class="fa fa-check"></i><b>23.20</b> Favourite big data / analytics products</a></li>
<li class="chapter" data-level="23.21" data-path="results.html"><a href="results.html#favourite-automated-machine-learning-tools-or-partial-automl-tools"><i class="fa fa-check"></i><b>23.21</b> Favourite automated machine learning tools (or partial AutoML tools)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine learning orientation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="MlAlgorithm" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> ML algorithms</h1>
<blockquote>
<p>A comparison of a several classifiers in scikit-learn on synthetic datasets. The point of this example is to illustrate the nature of decision boundaries of different classifiers. This should be taken with a grain of salt, as the intuition conveyed by these examples does not necessarily carry over to real datasets.</p>
<p>Particularly in high-dimensional spaces, data can more easily be separated linearly and the simplicity of classifiers such as naive Bayes and linear SVMs might lead to better generalization than is achieved by other classifiers.</p>
<p>The plots show training points in solid colors and testing points semi-transparent. The lower right shows the classification accuracy on the test set.</p>
<a href="https://scikit-learn.org/stable/auto_examples/classification/plot_classifier_comparison.html#sphx-glr-auto-examples-classification-plot-classifier-comparison-py" class="uri">https://scikit-learn.org/stable/auto_examples/classification/plot_classifier_comparison.html#sphx-glr-auto-examples-classification-plot-classifier-comparison-py</a>
</blockquote>
<p><img src="images/classificationCompare.png" style="width:120.0%" /></p>
<div id="MlAlgoLinReg" class="section level2">
<h2><span class="header-section-number">7.1</span> Linear regression TBD</h2>
<p>A linear regression is a regression analysis, a statistical method, at which a dependent variable is explained through several independent variables.</p>
<ul>
<li>Simple linear regression
<ul>
<li>Only one independent variable</li>
</ul></li>
<li>Multiple linear regression
<ul>
<li>more than one independent variables</li>
</ul></li>
</ul>
<p>Linear regression algorithm is one of the <strong>fundamental supervised learning algorithms</strong>.</p>
<div id="example-for-linear-regression" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Example for linear regression</h3>
<p>In this example the procedure of a linear regression is described</p>

<div class="HeadingNoNumber">
<p>Data</p>
</div>

<p>Given is a set of data created by a linear expression plus some noise</p>

<div class="rmdmath">
<p><span class="math display">\[y = 3*x+2+n\]</span>
where <span class="math inline">\(n\)</span> is noise</p>
</div>

<p>The data can be depicted as below. It is easy to be seen that we are looking at a linear function with superimposed noise.</p>
<p><img src="images/LrData.png" style="width:50.0%" /></p>

<div class="HeadingNoNumber">
<p>Model</p>
</div>

<p>The task is to find the value for <span class="math inline">\(w_0\)</span> and <span class="math inline">\(w_1\)</span> of a model which is as close as possible to the original function</p>

<div class="rmdmath">
<p><span class="math display">\[\hat{y} = w_0*x+w_1\]</span></p>
</div>


<div class="HeadingNoNumber">
<p>Loss function</p>
</div>

<p>The metric to define how good the model fits the data is defined as <strong>mean squared error (MSE)</strong></p>

<div class="rmdmath">
<p><span class="math display">\[L=(\hat{y}-y)^2\]</span></p>
</div>


<div class="HeadingNoNumber">
<p>Minimise loss function</p>
</div>

<p>The difference between <span class="math inline">\(\hat{y}\)</span> and <span class="math inline">\(y\)</span> shall be small <strong>stochastic gradient descent (SGD)</strong> can be applied.</p>

<div class="rmdtip">
<p>SGD:</p>
<ul>
<li>Iteratively updating values of <span class="math inline">\(w_0, w_1\)</span> using
<ul>
<li>gradient</li>
<li>learning rate <span class="math inline">\(\eta\)</span></li>
</ul></li>
</ul>
</div>

<p>In maths terms this can be written as:</p>

<div class="rmdmath">
<span class="math display">\[ w_{new} = w_{current} - \eta \frac{\partial L}{\partial w_{current}}\]</span>
</div>

<p>A graphical representation of SGD is given below. In this example the loss function can be depicted as a 3D plot. In the current case the surface is flat which makes it easy to find the <strong>global optimum</strong></p>
<hr />
<div class="figure">
<img src="images/sgdAnimation.gif" class="external" style="width:90.0%" alt="" />
<p class="caption">Figure from <a href="https://nbviewer.jupyter.org/gist/joshfp/85d96f07aaa5f4d2c9eb47956ccdcc88/lesson2-sgd-in-action.ipynb" class="uri">https://nbviewer.jupyter.org/gist/joshfp/85d96f07aaa5f4d2c9eb47956ccdcc88/lesson2-sgd-in-action.ipynb</a></p>
</div>
<hr />
</div>
</div>
<div id="MlAlgoLogReg" class="section level2">
<h2><span class="header-section-number">7.2</span> Logistic regression</h2>
<p>Logistic regression is similar to linear regression, however, the value range of the dependent variable y is limited to:</p>
<p><span class="math display">\[0\leq y \geq 1\]</span></p>
<p>Logistic regression is a algorithm with the low computational complexity TBD</p>

<div class="rmdtip">
<ul>
<li>Low computational complexity</li>
<li>y limited range of values <span class="math inline">\(0\leq y \geq 1\)</span></li>
<li>maps x on y (<span class="math inline">\(y \leftarrow x\)</span>) using the <a href="https://en.wikipedia.org/wiki/Logistic_function">logisit function</a><br />
</li>
<li>Used of classification</li>
</ul>
</div>

<p>The logistic function is depicted in the graph below</p>
<p><img src="Figs/logsiticFuncitonMlAlgo-1.png" width="60%" /></p>
<p>The logistic function is defined as:</p>

<div class="rmdmath">
<p>Logistic function:
<span class="math display">\[logistic(\eta) = \frac{1}{1+exp^{-\eta}}\]</span></p>
<p><span class="math display">\[P(Y = 1 \vert X_i = x_i) = \frac{1}{1+exp^{-(\beta_0 + \beta_1X_1+ \dots \beta_n X_n)}}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\beta_n\)</span> are the coeffcients we are searching</li>
<li><span class="math inline">\(X_n\)</span> are the features</li>
</ul>
</div>

<p>The second equation reads: The probability of <span class="math inline">\(Y=1\)</span> given the value <span class="math inline">\(X=x_i\)</span> which is exactly the result needed for a classification problem.</p>
<div id="python-example-logistic-regression" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Python example logistic regression</h3>
<p>An example of scikit-learn is given at <a href="https://scikit-learn.org/stable/auto_examples/linear_model/plot_logistic.html#sphx-glr-auto-examples-linear-model-plot-logistic-py" class="uri">https://scikit-learn.org/stable/auto_examples/linear_model/plot_logistic.html#sphx-glr-auto-examples-linear-model-plot-logistic-py</a> and emphasises on the difference between linear and logistic regression. The synthetic data set has values either 0 or 1. This can be modeled quite well with logisitc regression, but not at all with linear regression.</p>
<p><img src="images/logRegPython.png" style="width:70.0%" /></p>
<p>The python code is given below</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="MlAlgorithm.html#cb2-1"></a></span>
<span id="cb2-2"><a href="MlAlgorithm.html#cb2-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="MlAlgorithm.html#cb2-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-4"><a href="MlAlgorithm.html#cb2-4"></a></span>
<span id="cb2-5"><a href="MlAlgorithm.html#cb2-5"></a><span class="im">from</span> sklearn <span class="im">import</span> linear_model</span>
<span id="cb2-6"><a href="MlAlgorithm.html#cb2-6"></a><span class="im">from</span> scipy.special <span class="im">import</span> expit</span>
<span id="cb2-7"><a href="MlAlgorithm.html#cb2-7"></a></span>
<span id="cb2-8"><a href="MlAlgorithm.html#cb2-8"></a><span class="co"># General a toy dataset:s it&#39;s just a straight line with some Gaussian noise:</span></span>
<span id="cb2-9"><a href="MlAlgorithm.html#cb2-9"></a>xmin, xmax <span class="op">=</span> <span class="dv">-5</span>, <span class="dv">5</span></span>
<span id="cb2-10"><a href="MlAlgorithm.html#cb2-10"></a>n_samples <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb2-11"><a href="MlAlgorithm.html#cb2-11"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb2-12"><a href="MlAlgorithm.html#cb2-12"></a>X <span class="op">=</span> np.random.normal(size<span class="op">=</span>n_samples)</span>
<span id="cb2-13"><a href="MlAlgorithm.html#cb2-13"></a>y <span class="op">=</span> (X <span class="op">&gt;</span> <span class="dv">0</span>).astype(np.<span class="bu">float</span>)</span>
<span id="cb2-14"><a href="MlAlgorithm.html#cb2-14"></a>X[X <span class="op">&gt;</span> <span class="dv">0</span>] <span class="op">*=</span> <span class="dv">4</span></span>
<span id="cb2-15"><a href="MlAlgorithm.html#cb2-15"></a>X <span class="op">+=</span> <span class="fl">.3</span> <span class="op">*</span> np.random.normal(size<span class="op">=</span>n_samples)</span>
<span id="cb2-16"><a href="MlAlgorithm.html#cb2-16"></a></span>
<span id="cb2-17"><a href="MlAlgorithm.html#cb2-17"></a>X <span class="op">=</span> X[:, np.newaxis]</span>
<span id="cb2-18"><a href="MlAlgorithm.html#cb2-18"></a></span>
<span id="cb2-19"><a href="MlAlgorithm.html#cb2-19"></a><span class="co"># Fit the classifier</span></span>
<span id="cb2-20"><a href="MlAlgorithm.html#cb2-20"></a>clf <span class="op">=</span> linear_model.LogisticRegression(C<span class="op">=</span><span class="fl">1e5</span>)</span>
<span id="cb2-21"><a href="MlAlgorithm.html#cb2-21"></a>clf.fit(X, y)</span>
<span id="cb2-22"><a href="MlAlgorithm.html#cb2-22"></a></span>
<span id="cb2-23"><a href="MlAlgorithm.html#cb2-23"></a><span class="co"># and plot the result</span></span>
<span id="cb2-24"><a href="MlAlgorithm.html#cb2-24"></a>plt.figure(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">3</span>))</span>
<span id="cb2-25"><a href="MlAlgorithm.html#cb2-25"></a>plt.clf()</span>
<span id="cb2-26"><a href="MlAlgorithm.html#cb2-26"></a>plt.scatter(X.ravel(), y, color<span class="op">=</span><span class="st">&#39;black&#39;</span>, zorder<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb2-27"><a href="MlAlgorithm.html#cb2-27"></a>X_test <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">300</span>)</span>
<span id="cb2-28"><a href="MlAlgorithm.html#cb2-28"></a></span>
<span id="cb2-29"><a href="MlAlgorithm.html#cb2-29"></a>loss <span class="op">=</span> expit(X_test <span class="op">*</span> clf.coef_ <span class="op">+</span> clf.intercept_).ravel()</span>
<span id="cb2-30"><a href="MlAlgorithm.html#cb2-30"></a>plt.plot(X_test, loss, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, linewidth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb2-31"><a href="MlAlgorithm.html#cb2-31"></a></span>
<span id="cb2-32"><a href="MlAlgorithm.html#cb2-32"></a>ols <span class="op">=</span> linear_model.LinearRegression()</span>
<span id="cb2-33"><a href="MlAlgorithm.html#cb2-33"></a>ols.fit(X, y)</span>
<span id="cb2-34"><a href="MlAlgorithm.html#cb2-34"></a>plt.plot(X_test, ols.coef_ <span class="op">*</span> X_test <span class="op">+</span> ols.intercept_, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-35"><a href="MlAlgorithm.html#cb2-35"></a>plt.axhline(.<span class="dv">5</span>, color<span class="op">=</span><span class="st">&#39;.5&#39;</span>)</span>
<span id="cb2-36"><a href="MlAlgorithm.html#cb2-36"></a></span>
<span id="cb2-37"><a href="MlAlgorithm.html#cb2-37"></a>plt.ylabel(<span class="st">&#39;y&#39;</span>)</span>
<span id="cb2-38"><a href="MlAlgorithm.html#cb2-38"></a>plt.xlabel(<span class="st">&#39;X&#39;</span>)</span>
<span id="cb2-39"><a href="MlAlgorithm.html#cb2-39"></a>plt.xticks(<span class="bu">range</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">10</span>))</span>
<span id="cb2-40"><a href="MlAlgorithm.html#cb2-40"></a>plt.yticks([<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>])</span>
<span id="cb2-41"><a href="MlAlgorithm.html#cb2-41"></a>plt.ylim(<span class="op">-</span>.<span class="dv">25</span>, <span class="fl">1.25</span>)</span>
<span id="cb2-42"><a href="MlAlgorithm.html#cb2-42"></a>plt.xlim(<span class="op">-</span><span class="dv">4</span>, <span class="dv">10</span>)</span>
<span id="cb2-43"><a href="MlAlgorithm.html#cb2-43"></a>plt.legend((<span class="st">&#39;Logistic Regression Model&#39;</span>, <span class="st">&#39;Linear Regression Model&#39;</span>),</span>
<span id="cb2-44"><a href="MlAlgorithm.html#cb2-44"></a>           loc<span class="op">=</span><span class="st">&quot;lower right&quot;</span>, fontsize<span class="op">=</span><span class="st">&#39;small&#39;</span>)</span>
<span id="cb2-45"><a href="MlAlgorithm.html#cb2-45"></a>plt.tight_layout()</span>
<span id="cb2-46"><a href="MlAlgorithm.html#cb2-46"></a>plt.show()</span></code></pre></div>

</div>
</div>
<div id="MlAlgoTrees" class="section level2">
<h2><span class="header-section-number">7.3</span> Tree based methods TBD</h2>
<p>Tree based methods can be used for different predictions:</p>

<div class="rmdtip">
<p>Types of predictions:</p>
<ul>
<li>Regression trees
<ul>
<li>predict quantitative response</li>
</ul></li>
<li>Classification trees
<ul>
<li>predict qualitative response</li>
</ul></li>
</ul>
</div>

<hr />
<p><img src="images/typesOfTrees.png" style="width:90.0%" /></p>
<hr />
<p>Depending on the task the metric to decide how to split the data is different:</p>

<div class="rmdtip">
<p>Metric for splits:</p>
<ul>
<li>Regression
<ul>
<li>Residual sum of squares (<a href="https://en.wikipedia.org/wiki/Residual_sum_of_squares">RSS</a>)</li>
<li>Goal is to minimize the value</li>
</ul></li>
<li>Classification
<ul>
<li><a href="https://en.wikipedia.org/wiki/Decision_tree">Gini index</a></li>
<li><a href="https://en.wikipedia.org/wiki/Cross_entropy">Cross entropy</a></li>
<li>Both metrics are numerically very similar</li>
<li>Goal is to minimize the value</li>
</ul></li>
</ul>
</div>

<div id="splitting-metrics" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Splitting metrics</h3>
<p>Deciding how to split the data at a node is done based on metrics which shall be minimal for the split</p>

<div class="rmdtip">
<p>Residual sum of squares (RSS):</p>
<ul>
<li>Regression trees</li>
<li>How close are the samples to the mean of all samples in the resulting node<br />
</li>
<li><span class="math inline">\(RSS = \sum_{k=1}^{K}\sum_{bi€R_j}(y_i-\hat{y}_{Rj})^2\)</span></li>
</ul>
<p>Gini index:</p>
<ul>
<li>Classification</li>
<li>How pure is are the resulting leafs<br />
</li>
<li><span class="math inline">\(G = \sum_{k=1}^{K}p_i(1-p_i)\)</span></li>
</ul>
<p>Cross-entropy:</p>
<ul>
<li><p>How pure is are the resulting leafs</p></li>
<li><p><span class="math inline">\(D = - \sum_{k=1}^{K}p_i \log_{10}(p_i)\)</span></p>
</div></li>
</ul>
<p>An example on how the gini value changes
<img src="images/giniTreeExample.png" style="width:100.0%" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="MlAlgorithm.html#cb3-1"></a><span class="co"># source: https://scikit-learn.org/stable/auto_examples/tree/plot_iris_dtc.html#sphx-glr-auto-examples-tree-plot-iris-dtc-py</span></span>
<span id="cb3-2"><a href="MlAlgorithm.html#cb3-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="MlAlgorithm.html#cb3-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-4"><a href="MlAlgorithm.html#cb3-4"></a></span>
<span id="cb3-5"><a href="MlAlgorithm.html#cb3-5"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb3-6"><a href="MlAlgorithm.html#cb3-6"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb3-7"><a href="MlAlgorithm.html#cb3-7"></a></span>
<span id="cb3-8"><a href="MlAlgorithm.html#cb3-8"></a><span class="co"># Parameters</span></span>
<span id="cb3-9"><a href="MlAlgorithm.html#cb3-9"></a>n_classes <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb3-10"><a href="MlAlgorithm.html#cb3-10"></a>plot_colors <span class="op">=</span> <span class="st">&quot;ryb&quot;</span></span>
<span id="cb3-11"><a href="MlAlgorithm.html#cb3-11"></a>plot_step <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb3-12"><a href="MlAlgorithm.html#cb3-12"></a></span>
<span id="cb3-13"><a href="MlAlgorithm.html#cb3-13"></a><span class="co"># Load data</span></span>
<span id="cb3-14"><a href="MlAlgorithm.html#cb3-14"></a>iris <span class="op">=</span> load_iris()</span>
<span id="cb3-15"><a href="MlAlgorithm.html#cb3-15"></a></span>
<span id="cb3-16"><a href="MlAlgorithm.html#cb3-16"></a><span class="cf">for</span> pairidx, pair <span class="kw">in</span> <span class="bu">enumerate</span>([[<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">2</span>], [<span class="dv">0</span>, <span class="dv">3</span>],</span>
<span id="cb3-17"><a href="MlAlgorithm.html#cb3-17"></a>                                [<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">1</span>, <span class="dv">3</span>], [<span class="dv">2</span>, <span class="dv">3</span>]]):</span>
<span id="cb3-18"><a href="MlAlgorithm.html#cb3-18"></a>    <span class="co"># We only take the two corresponding features</span></span>
<span id="cb3-19"><a href="MlAlgorithm.html#cb3-19"></a>    X <span class="op">=</span> iris.data[:, pair]</span>
<span id="cb3-20"><a href="MlAlgorithm.html#cb3-20"></a>    y <span class="op">=</span> iris.target</span>
<span id="cb3-21"><a href="MlAlgorithm.html#cb3-21"></a></span>
<span id="cb3-22"><a href="MlAlgorithm.html#cb3-22"></a>    <span class="co"># Train</span></span>
<span id="cb3-23"><a href="MlAlgorithm.html#cb3-23"></a>    clf <span class="op">=</span> DecisionTreeClassifier().fit(X, y)</span>
<span id="cb3-24"><a href="MlAlgorithm.html#cb3-24"></a></span>
<span id="cb3-25"><a href="MlAlgorithm.html#cb3-25"></a>    <span class="co"># Plot the decision boundary</span></span>
<span id="cb3-26"><a href="MlAlgorithm.html#cb3-26"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, pairidx <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb3-27"><a href="MlAlgorithm.html#cb3-27"></a></span>
<span id="cb3-28"><a href="MlAlgorithm.html#cb3-28"></a>    x_min, x_max <span class="op">=</span> X[:, <span class="dv">0</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="dv">1</span>, X[:, <span class="dv">0</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb3-29"><a href="MlAlgorithm.html#cb3-29"></a>    y_min, y_max <span class="op">=</span> X[:, <span class="dv">1</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="dv">1</span>, X[:, <span class="dv">1</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb3-30"><a href="MlAlgorithm.html#cb3-30"></a>    xx, yy <span class="op">=</span> np.meshgrid(np.arange(x_min, x_max, plot_step),</span>
<span id="cb3-31"><a href="MlAlgorithm.html#cb3-31"></a>                         np.arange(y_min, y_max, plot_step))</span>
<span id="cb3-32"><a href="MlAlgorithm.html#cb3-32"></a>    plt.tight_layout(h_pad<span class="op">=</span><span class="fl">0.5</span>, w_pad<span class="op">=</span><span class="fl">0.5</span>, pad<span class="op">=</span><span class="fl">2.5</span>)</span>
<span id="cb3-33"><a href="MlAlgorithm.html#cb3-33"></a></span>
<span id="cb3-34"><a href="MlAlgorithm.html#cb3-34"></a>    Z <span class="op">=</span> clf.predict(np.c_[xx.ravel(), yy.ravel()])</span>
<span id="cb3-35"><a href="MlAlgorithm.html#cb3-35"></a>    Z <span class="op">=</span> Z.reshape(xx.shape)</span>
<span id="cb3-36"><a href="MlAlgorithm.html#cb3-36"></a>    cs <span class="op">=</span> plt.contourf(xx, yy, Z, cmap<span class="op">=</span>plt.cm.RdYlBu)</span>
<span id="cb3-37"><a href="MlAlgorithm.html#cb3-37"></a></span>
<span id="cb3-38"><a href="MlAlgorithm.html#cb3-38"></a>    plt.xlabel(iris.feature_names[pair[<span class="dv">0</span>]])</span>
<span id="cb3-39"><a href="MlAlgorithm.html#cb3-39"></a>    plt.ylabel(iris.feature_names[pair[<span class="dv">1</span>]])</span>
<span id="cb3-40"><a href="MlAlgorithm.html#cb3-40"></a></span>
<span id="cb3-41"><a href="MlAlgorithm.html#cb3-41"></a>    <span class="co"># Plot the training points</span></span>
<span id="cb3-42"><a href="MlAlgorithm.html#cb3-42"></a>    <span class="cf">for</span> i, color <span class="kw">in</span> <span class="bu">zip</span>(<span class="bu">range</span>(n_classes), plot_colors):</span>
<span id="cb3-43"><a href="MlAlgorithm.html#cb3-43"></a>        idx <span class="op">=</span> np.where(y <span class="op">==</span> i)</span>
<span id="cb3-44"><a href="MlAlgorithm.html#cb3-44"></a>        plt.scatter(X[idx, <span class="dv">0</span>], X[idx, <span class="dv">1</span>], c<span class="op">=</span>color, label<span class="op">=</span>iris.target_names[i],</span>
<span id="cb3-45"><a href="MlAlgorithm.html#cb3-45"></a>                    cmap<span class="op">=</span>plt.cm.RdYlBu, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>, s<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb3-46"><a href="MlAlgorithm.html#cb3-46"></a></span>
<span id="cb3-47"><a href="MlAlgorithm.html#cb3-47"></a>plt.suptitle(<span class="st">&quot;Decision surface of a decision tree using paired features&quot;</span>)</span>
<span id="cb3-48"><a href="MlAlgorithm.html#cb3-48"></a>plt.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>, borderpad<span class="op">=</span><span class="dv">0</span>, handletextpad<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-49"><a href="MlAlgorithm.html#cb3-49"></a>plt.axis(<span class="st">&quot;tight&quot;</span>)</span>
<span id="cb3-50"><a href="MlAlgorithm.html#cb3-50"></a></span>
<span id="cb3-51"><a href="MlAlgorithm.html#cb3-51"></a>plt.figure(dpi <span class="op">=</span> <span class="dv">300</span>) <span class="co"># Uwe Sterr added dpi argument for better readability of plot</span></span>
<span id="cb3-52"><a href="MlAlgorithm.html#cb3-52"></a>clf <span class="op">=</span> DecisionTreeClassifier().fit(iris.data, iris.target)</span>
<span id="cb3-53"><a href="MlAlgorithm.html#cb3-53"></a>plot_tree(clf, filled<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-54"><a href="MlAlgorithm.html#cb3-54"></a>plt.show()</span></code></pre></div>
</div>
<div id="ensembles" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Ensembles</h3>
<p>Prediction ability of a single decision tree is limited, several techniques are employed to enhance the ability. All of them are aimed at buidling a ensemble of trees which combined have a higher prediction ability than a single tree.</p>

<div class="rmdtip">
<p>Ensembling methods:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">Bootstrap</a>
<ul>
<li>random sample with replacement</li>
</ul></li>
<li><a href="https://en.wikipedia.org/wiki/Bootstrap_aggregating">Bagging</a>
<ul>
<li>short for <strong>b</strong>ootstrap and <strong>agg</strong>regation</li>
<li>used for example with random forests</li>
</ul></li>
<li><a href="https://en.wikipedia.org/wiki/Gradient_boosting">Boosting</a>
<ul>
<li>build several trees</li>
<li>trees learn from errors of previous trees</li>
</ul></li>
</ul>
</div>

<div id="bootstrap" class="section level4">
<h4><span class="header-section-number">7.3.2.1</span> Bootstrap</h4>
<p><a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">Bootstrapping</a> is resembling method that relies on sampling with replacement as shown in the image below</p>
<hr />
<p><img src="images/bootstrap.png" style="width:60.0%" /></p>
<hr />
<p>Bootstrap is a widely applicable and extremely powerful statistical tool that allow assigning measures of accuracy associated with a given estimator or statistical learning method.<br />
It is used by the random forest algorithm as described in chapter <a href="MlAlgorithm.html#MlAlgoTreesRandomForest">7.3.3</a></p>
</div>
<div id="bagging" class="section level4">
<h4><span class="header-section-number">7.3.2.2</span> Bagging</h4>
<p><a href="https://en.wikipedia.org/wiki/Bootstrap_aggregating">Bagging</a> is short for <strong>b</strong>ootstrap and <strong>agg</strong>regation and is a general purpose procedure for reducing the variance of a machine learning algorithm. It is particularly useful and frequently used in the context of decision trees.</p>
<p>For random forests the method works as follows:</p>

<div class="rmdtip">
<p>Bootstrapping for random forest:</p>
<ul>
<li>Generate training data by bootstrapping from the original training data set</li>
<li>Generate a tree</li>
<li>Repeat this M times</li>
<li>Predict by averaging the predictions of all trees</li>
</ul>
</div>

</div>
<div id="boosting" class="section level4">
<h4><span class="header-section-number">7.3.2.3</span> Boosting</h4>
<p><a href="https://en.wikipedia.org/wiki/Gradient_boosting">Boosting</a> can be utilized for regression and classification problems. It produces an ensemble of weak learners, typically decision trees. The models are build sequentially allowing optimization of an arbitrary differentiable loss function.
An example on how boosting works for tree is given in chapter <a href="MlAlgorithm.html#MlAlgoTreesGBM">7.3.4</a></p>
</div>
<div id="types-of-decision-trees" class="section level4">
<h4><span class="header-section-number">7.3.2.4</span> Types of decision trees</h4>
<p>Two dominant decision tree concepts are:</p>
<hr />
<p><img src="images/TreeAlogo.png" style="width:90.0%" /></p>
<hr />
<p>Two dominant concepts used for ensemble trees are described at:</p>
<ul>
<li>Random forest in chapter <a href="MlAlgorithm.html#MlAlgoTreesRandomForest">7.3.3</a></li>
<li>Gradient boosted trees in chapter <a href="MlAlgorithm.html#MlAlgoTreesGBM">7.3.4</a></li>
</ul>
</div>
</div>
<div id="MlAlgoTreesRandomForest" class="section level3">
<h3><span class="header-section-number">7.3.3</span> Random forest TBD</h3>
<p>Random forest has its name from the randomly selected predictors at each split. The Algorithm is described in <span class="citation">(Kuhn and Johnson <a href="#ref-kuhn2013applied" role="doc-biblioref">2013</a>)</span> p. 200:</p>

<div class="rmdtip">
<p>Random forest algorithm:</p>
<ul>
<li>Select number of models to build <em>m</em></li>
<li>for each model
<ul>
<li>generate bootstrap sample of the original data</li>
<li>train a tree model for this sample
<ul>
<li>at each split</li>
<li>select randomly <em>k</em> of the original predictors</li>
<li>select best predictor</li>
<li>partition the data</li>
</ul></li>
<li>until model stop criteria is meet</li>
</ul></li>
<li>average prediction of all trees for new samples<br />
</li>
</ul>
</div>

<p>The algorithm can be depicted as below</p>
<p><img src="images/randomForest.png" style="width:90.0%" /></p>
<p>Random forests have weaknesses and strengths</p>

<div class="rmdtip">
<p>Pros and cons of random forest:</p>
<ul>
<li>Pro
<ul>
<li>Handle higher dimensionality data very well</li>
<li>Handles missing values well</li>
</ul></li>
<li>Cons
<ul>
<li>Due to aggregation of all trees no precise values for regression</li>
</ul></li>
</ul>
</div>

<div id="python-example-for-random-forest" class="section level4">
<h4><span class="header-section-number">7.3.3.1</span> Python example for random forest</h4>
<p>The sample code for a random forest classifier produces a ROC image as shown below</p>
<p><img src="images/rocRfPython.png" style="width:60.0%" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="MlAlgorithm.html#cb4-1"></a></span>
<span id="cb4-2"><a href="MlAlgorithm.html#cb4-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="MlAlgorithm.html#cb4-3"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb4-4"><a href="MlAlgorithm.html#cb4-4"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> plot_roc_curve</span>
<span id="cb4-5"><a href="MlAlgorithm.html#cb4-5"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_wine</span>
<span id="cb4-6"><a href="MlAlgorithm.html#cb4-6"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb4-7"><a href="MlAlgorithm.html#cb4-7"></a></span>
<span id="cb4-8"><a href="MlAlgorithm.html#cb4-8"></a>X, y <span class="op">=</span> load_wine(return_X_y<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-9"><a href="MlAlgorithm.html#cb4-9"></a>y <span class="op">=</span> y <span class="op">==</span> <span class="dv">2</span></span>
<span id="cb4-10"><a href="MlAlgorithm.html#cb4-10"></a></span>
<span id="cb4-11"><a href="MlAlgorithm.html#cb4-11"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb4-12"><a href="MlAlgorithm.html#cb4-12"></a></span>
<span id="cb4-13"><a href="MlAlgorithm.html#cb4-13"></a>rfc <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">10</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb4-14"><a href="MlAlgorithm.html#cb4-14"></a>rfc.fit(X_train, y_train)</span>
<span id="cb4-15"><a href="MlAlgorithm.html#cb4-15"></a>ax <span class="op">=</span> plt.gca()</span>
<span id="cb4-16"><a href="MlAlgorithm.html#cb4-16"></a>rfc_disp <span class="op">=</span> plot_roc_curve(rfc, X_test, y_test, ax<span class="op">=</span>ax, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb4-17"><a href="MlAlgorithm.html#cb4-17"></a>plt.show()</span></code></pre></div>
</div>
<div id="parameters-for-random-forest" class="section level4">
<h4><span class="header-section-number">7.3.3.2</span> Parameters for random forest</h4>
<p>The parameters are from the scikit-learn webpage <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier" class="uri">https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier</a></p>
<dd class="field-odd">
<dl>
<dt>
<strong>n_estimators</strong><span class="classifier">integer, optional (default=100)</span>
</dt>
<dd>
<p>
The number of trees in the forest.
</p>
<div class="versionchanged">
<p>
<span class="versionmodified changed">Changed in version 0.22: </span>The default value of <code class="docutils literal notranslate"><span class="pre">n_estimators</span></code> changed from 10 to 100
in 0.22.
</p>
</div>
</dd>
<dt>
<strong>criterion</strong><span class="classifier">string, optional (default=”gini”)</span>
</dt>
<dd>
<p>
The function to measure the quality of a split. Supported criteria are
“gini” for the Gini impurity and “entropy” for the information gain.
Note: this parameter is tree-specific.
</p>
</dd>
<dt>
<strong>max_depth</strong><span class="classifier">integer or None, optional (default=None)</span>
</dt>
<dd>
<p>
The maximum depth of the tree. If None, then nodes are expanded until
all leaves are pure or until all leaves contain less than
min_samples_split samples.
</p>
</dd>
<dt>
<strong>min_samples_split</strong><span class="classifier">int, float, optional (default=2)</span>
</dt>
<dd>
<p>
The minimum number of samples required to split an internal node:
</p>
<ul class="simple">
<li>
<p>
If int, then consider <code class="docutils literal notranslate"><span class="pre">min_samples_split</span></code> as the minimum number.
</p>
</li>
<li>
<p>
If float, then <code class="docutils literal notranslate"><span class="pre">min_samples_split</span></code> is a fraction and
<code class="docutils literal notranslate"><span class="pre">ceil(min_samples_split</span> <span class="pre">*</span> <span class="pre">n_samples)</span></code> are the minimum
number of samples for each split.
</p>
</li>
</ul>
<div class="versionchanged">
<p>
<span class="versionmodified changed">Changed in version 0.18: </span>Added float values for fractions.
</p>
</div>
</dd>
<dt>
<strong>min_samples_leaf</strong><span class="classifier">int, float, optional (default=1)</span>
</dt>
<dd>
<p>
The minimum number of samples required to be at a leaf node.
A split point at any depth will only be considered if it leaves at
least <code class="docutils literal notranslate"><span class="pre">min_samples_leaf</span></code> training samples in each of the left and
right branches. This may have the effect of smoothing the model,
especially in regression.
</p>
<ul class="simple">
<li>
<p>
If int, then consider <code class="docutils literal notranslate"><span class="pre">min_samples_leaf</span></code> as the minimum number.
</p>
</li>
<li>
<p>
If float, then <code class="docutils literal notranslate"><span class="pre">min_samples_leaf</span></code> is a fraction and
<code class="docutils literal notranslate"><span class="pre">ceil(min_samples_leaf</span> <span class="pre">*</span> <span class="pre">n_samples)</span></code> are the minimum
number of samples for each node.
</p>
</li>
</ul>
<div class="versionchanged">
<p>
<span class="versionmodified changed">Changed in version 0.18: </span>Added float values for fractions.
</p>
</div>
</dd>
<dt>
<strong>min_weight_fraction_leaf</strong><span class="classifier">float, optional (default=0.)</span>
</dt>
<dd>
<p>
The minimum weighted fraction of the sum total of weights (of all
the input samples) required to be at a leaf node. Samples have
equal weight when sample_weight is not provided.
</p>
</dd>
<dt>
<strong>max_features</strong><span class="classifier">int, float, string or None, optional (default=”auto”)</span>
</dt>
<dd>
<p>
The number of features to consider when looking for the best split:
</p>
<ul class="simple">
<li>
<p>
If int, then consider <code class="docutils literal notranslate"><span class="pre">max_features</span></code> features at each split.
</p>
</li>
<li>
<p>
If float, then <code class="docutils literal notranslate"><span class="pre">max_features</span></code> is a fraction and
<code class="docutils literal notranslate"><span class="pre">int(max_features</span> <span class="pre">*</span> <span class="pre">n_features)</span></code> features are considered at each
split.
</p>
</li>
<li>
<p>
If “auto”, then <code class="docutils literal notranslate"><span class="pre">max_features=sqrt(n_features)</span></code>.
</p>
</li>
<li>
<p>
If “sqrt”, then <code class="docutils literal notranslate"><span class="pre">max_features=sqrt(n_features)</span></code> (same as “auto”).
</p>
</li>
<li>
<p>
If “log2”, then <code class="docutils literal notranslate"><span class="pre">max_features=log2(n_features)</span></code>.
</p>
</li>
<li>
<p>
If None, then <code class="docutils literal notranslate"><span class="pre">max_features=n_features</span></code>.
</p>
</li>
</ul>
<p>
Note: the search for a split does not stop until at least one
valid partition of the node samples is found, even if it requires to
effectively inspect more than <code class="docutils literal notranslate"><span class="pre">max_features</span></code> features.
</p>
</dd>
<dt>
<strong>max_leaf_nodes</strong><span class="classifier">int or None, optional (default=None)</span>
</dt>
<dd>
<p>
Grow trees with <code class="docutils literal notranslate"><span class="pre">max_leaf_nodes</span></code> in best-first fashion.
Best nodes are defined as relative reduction in impurity.
If None then unlimited number of leaf nodes.
</p>
</dd>
<dt>
<strong>min_impurity_decrease</strong><span class="classifier">float, optional (default=0.)</span>
</dt>
<dd>
<p>
A node will be split if this split induces a decrease of the impurity
greater than or equal to this value.
</p>
<p>
The weighted impurity decrease equation is the following:
</p>
<div class="highlight-default notranslate" style="position: relative;">
<div class="highlight">
<pre><span></span><span class="n">N_t</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">impurity</span> <span class="o">-</span> <span class="n">N_t_R</span> <span class="o">/</span> <span class="n">N_t</span> <span class="o">*</span> <span class="n">right_impurity</span>
                    <span class="o">-</span> <span class="n">N_t_L</span> <span class="o">/</span> <span class="n">N_t</span> <span class="o">*</span> <span class="n">left_impurity</span><span class="p">)</span>
</pre>
</div>
</div>
<p>
where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the total number of samples, <code class="docutils literal notranslate"><span class="pre">N_t</span></code> is the number of
samples at the current node, <code class="docutils literal notranslate"><span class="pre">N_t_L</span></code> is the number of samples in the
left child, and <code class="docutils literal notranslate"><span class="pre">N_t_R</span></code> is the number of samples in the right child.
</p>
<p>
<code class="docutils literal notranslate"><span class="pre">N</span></code>, <code class="docutils literal notranslate"><span class="pre">N_t</span></code>, <code class="docutils literal notranslate"><span class="pre">N_t_R</span></code> and <code class="docutils literal notranslate"><span class="pre">N_t_L</span></code> all refer to the weighted sum,
if <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> is passed.
</p>
<div class="versionadded">
<p>
<span class="versionmodified added">New in version 0.19.</span>
</p>
</div>
</dd>
<dt>
<strong>min_impurity_split</strong><span class="classifier">float, (default=1e-7)</span>
</dt>
<dd>
<p>
Threshold for early stopping in tree growth. A node will split
if its impurity is above the threshold, otherwise it is a leaf.
</p>
<div class="deprecated">
<p>
<span class="versionmodified deprecated">Deprecated since version 0.19: </span><code class="docutils literal notranslate"><span class="pre">min_impurity_split</span></code> has been deprecated in favor of
<code class="docutils literal notranslate"><span class="pre">min_impurity_decrease</span></code> in 0.19. The default value of
<code class="docutils literal notranslate"><span class="pre">min_impurity_split</span></code> will change from 1e-7 to 0 in 0.23 and it
will be removed in 0.25. Use <code class="docutils literal notranslate"><span class="pre">min_impurity_decrease</span></code> instead.
</p>
</div>
</dd>
<dt>
<strong>bootstrap</strong><span class="classifier">boolean, optional (default=True)</span>
</dt>
<dd>
<p>
Whether bootstrap samples are used when building trees. If False, the
whole datset is used to build each tree.
</p>
</dd>
<dt>
<strong>oob_score</strong><span class="classifier">bool (default=False)</span>
</dt>
<dd>
<p>
Whether to use out-of-bag samples to estimate
the generalization accuracy.
</p>
</dd>
<dt>
<strong>n_jobs</strong><span class="classifier">int or None, optional (default=None)</span>
</dt>
<dd>
<p>
The number of jobs to run in parallel. <a class="reference internal" href="#sklearn.ensemble.RandomForestClassifier.fit" title="sklearn.ensemble.RandomForestClassifier.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a>, <a class="reference internal" href="#sklearn.ensemble.RandomForestClassifier.predict" title="sklearn.ensemble.RandomForestClassifier.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict</span></code></a>,
<a class="reference internal" href="#sklearn.ensemble.RandomForestClassifier.decision_path" title="sklearn.ensemble.RandomForestClassifier.decision_path"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decision_path</span></code></a> and <a class="reference internal" href="#sklearn.ensemble.RandomForestClassifier.apply" title="sklearn.ensemble.RandomForestClassifier.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply</span></code></a> are all parallelized over the
trees. <code class="docutils literal notranslate"><span class="pre">None</span></code> means 1 unless in a <a class="reference external" href="https://joblib.readthedocs.io/en/latest/parallel.html#joblib.parallel_backend" title="(in joblib v0.14.1.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">joblib.parallel_backend</span></code></a>
context. <code class="docutils literal notranslate"><span class="pre">-1</span></code> means using all processors. See <a class="reference internal" href="../../glossary.html#term-n-jobs"><span class="xref std std-term">Glossary</span></a> for more details.
</p>
</dd>
<dt>
<strong>random_state</strong><span class="classifier">int, RandomState instance or None, optional (default=None)</span>
</dt>
<dd>
<p>
Controls both the randomness of the bootstrapping of the samples used
when building trees (if <code class="docutils literal notranslate"><span class="pre">bootstrap=True</span></code>) and the sampling of the
features to consider when looking for the best split at each node
(if <code class="docutils literal notranslate"><span class="pre">max_features</span> <span class="pre">&lt;</span> <span class="pre">n_features</span></code>).
See <a class="reference internal" href="../../glossary.html#term-random-state"><span class="xref std std-term">Glossary</span></a> for details.
</p>
</dd>
<dt>
<strong>verbose</strong><span class="classifier">int, optional (default=0)</span>
</dt>
<dd>
<p>
Controls the verbosity when fitting and predicting.
</p>
</dd>
<dt>
<strong>warm_start</strong><span class="classifier">bool, optional (default=False)</span>
</dt>
<dd>
<p>
When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, reuse the solution of the previous call to fit
and add more estimators to the ensemble, otherwise, just fit a whole
new forest. See <a class="reference internal" href="../../glossary.html#term-warm-start"><span class="xref std std-term">the Glossary</span></a>.
</p>
</dd>
<dt>
<strong>class_weight</strong><span class="classifier">dict, list of dicts, “balanced”, “balanced_subsample” or None, optional (default=None)</span>
</dt>
<dd>
<p>
Weights associated with classes in the form <code class="docutils literal notranslate"><span class="pre">{class_label:</span> <span class="pre">weight}</span></code>.
If not given, all classes are supposed to have weight one. For
multi-output problems, a list of dicts can be provided in the same
order as the columns of y.
</p>
<p>
Note that for multioutput (including multilabel) weights should be
defined for each class of every column in its own dict. For example,
for four-class multilabel classification weights should be
[{0: 1, 1: 1}, {0: 1, 1: 5}, {0: 1, 1: 1}, {0: 1, 1: 1}] instead of
[{1:1}, {2:5}, {3:1}, {4:1}].
</p>
<p>
The “balanced” mode uses the values of y to automatically adjust
weights inversely proportional to class frequencies in the input data
as <code class="docutils literal notranslate"><span class="pre">n_samples</span> <span class="pre">/</span> <span class="pre">(n_classes</span> <span class="pre">*</span> <span class="pre">np.bincount(y))</span></code>
</p>
<p>
The “balanced_subsample” mode is the same as “balanced” except that
weights are computed based on the bootstrap sample for every tree
grown.
</p>
<p>
For multi-output, the weights of each column of y will be multiplied.
</p>
<p>
Note that these weights will be multiplied with sample_weight (passed
through the fit method) if sample_weight is specified.
</p>
</dd>
<dt>
<strong>ccp_alpha</strong><span class="classifier">non-negative float, optional (default=0.0)</span>
</dt>
<dd>
<p>
Complexity parameter used for Minimal Cost-Complexity Pruning. The
subtree with the largest cost complexity that is smaller than
<code class="docutils literal notranslate"><span class="pre">ccp_alpha</span></code> will be chosen. By default, no pruning is performed. See
<a class="reference internal" href="../tree.html#minimal-cost-complexity-pruning"><span class="std std-ref">Minimal Cost-Complexity Pruning</span></a> for details.
</p>
<div class="versionadded">
<p>
<span class="versionmodified added">New in version 0.22.</span>
</p>
</div>
</dd>
<dt>
<strong>max_samples</strong><span class="classifier">int or float, default=None</span>
</dt>
<dd>
<p>
If bootstrap is True, the number of samples to draw from X
to train each base estimator.
</p>
<ul class="simple">
<li>
<p>
If None (default), then draw <code class="docutils literal notranslate"><span class="pre">X.shape[0]</span></code> samples.
</p>
</li>
<li>
<p>
If int, then draw <code class="docutils literal notranslate"><span class="pre">max_samples</span></code> samples.
</p>
</li>
<li>
<p>
If float, then draw <code class="docutils literal notranslate"><span class="pre">max_samples</span> <span class="pre">*</span> <span class="pre">X.shape[0]</span></code> samples. Thus,
<code class="docutils literal notranslate"><span class="pre">max_samples</span></code> should be in the interval <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1)</span></code>.
</p>
</li>
</ul>
<div class="versionadded">
<p>
<span class="versionmodified added">New in version 0.22.</span>
</p>
</div>
</dd>
</dl>
</dd>
</div>
</div>
<div id="MlAlgoTreesGBM" class="section level3">
<h3><span class="header-section-number">7.3.4</span> Boosted trees TBD</h3>
<p>Boosted trees are an ensemble of weak learners where each learner is build on the knowledge gained by all previous learners.</p>
<p>The following image depicts the algorithm which can be summarized:</p>

<div class="rmdtip">
<p>Boosted tree algorithm</p>
<ol style="list-style-type: decimal">
<li>Generate small tree</li>
<li>Calculate residuals for all samples</li>
<li>Use residuals to generate next tree</li>
<li>Combine all trees to build new model</li>
<li>Repeat from step 1.</li>
</ol>
</div>

<p>The algorithm is depicted below</p>
<hr />
<div class="figure">
<img src="images/gradientBoostedTreesSimple.png" class="external" style="width:100.0%" alt="" />
<p class="caption">Figure based on <span class="citation">(Zhang et al. <a href="#ref-zhang2018exploring" role="doc-biblioref">2018</a>)</span>, added explanation at the right hand side</p>
</div>
<hr />
<p>Boosted trees have weaknesses and strengths</p>

<div class="rmdtip">
<p>Pros and cons of boosted trees:</p>
<ul>
<li>Pro
<ul>
<li>Supports different loss functions</li>
</ul></li>
<li>Cons
<ul>
<li>Prone to overfitting</li>
<li>Carefully tuning of hyperparameters is required</li>
</ul></li>
</ul>
</div>

<p>The algorithm of boosted trees for regression is described in a rather mathematically way in <span class="citation">(James et al. <a href="#ref-james2013introduction" role="doc-biblioref">2013</a>)</span> p. 323:</p>

<div class="rmdtip">
<ol style="list-style-type: decimal">
<li>Set <span class="math inline">\(\hat{f} = 0\)</span> and <span class="math inline">\(r_i = y_i\)</span> for all <span class="math inline">\(i\)</span> in the training set</li>
<li>For <span class="math inline">\(b=1,2,\dots,B\)</span> repeat:
<ol style="list-style-type: lower-alpha">
<li>Fit a tree <span class="math inline">\(\hat{f}^b\)</span> with <span class="math inline">\(d\)</span> splits (<span class="math inline">\(d+1\)</span> terminal nodes) to the training data <span class="math inline">\((X,r)\)</span></li>
<li>Update <span class="math inline">\(\hat{f}\)</span> by adding in a shrunken version of the new tree <span class="math inline">\(\hat{f}(x) \leftarrow \hat{f}(x) + \lambda \hat{f}^b(x)\)</span></li>
<li>Update the residuals <span class="math inline">\(r_i \leftarrow r_i + \lambda \hat{f}^b(x_i)\)</span></li>
</ol></li>
<li>Output the boosted model <span class="math inline">\(\hat{f}(x) = \sum_{b=1}^{B}\lambda \hat{f}^b(x)\)</span></li>
</ol>
</div>

<p>Another introduction to boosted trees is given at the <a href="https://xgboost.readthedocs.io/en/latest/tutorials/model.html">XGBoost Documentation</a> with a thorough mathematical explanation of the approach.</p>
<div id="python-examples-for-boosted-trees" class="section level4">
<h4><span class="header-section-number">7.3.4.1</span> Python examples for boosted trees</h4>
<p>A popular library for boosted trees in Python is <strong>XGBoost</strong>, the documentation is hosted at <a href="https://xgboost.readthedocs.io/en/latest/" class="uri">https://xgboost.readthedocs.io/en/latest/</a>.<br />
Plenty of examples are on the GitHub page <a href="https://github.com/dmlc/xgboost/tree/master/demo/guide-python" class="uri">https://github.com/dmlc/xgboost/tree/master/demo/guide-python</a>.</p>
<p>The example script <strong>basic_walkthrough.py</strong> is shown below</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="MlAlgorithm.html#cb5-1"></a><span class="co">#!/usr/bin/python</span></span>
<span id="cb5-2"><a href="MlAlgorithm.html#cb5-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-3"><a href="MlAlgorithm.html#cb5-3"></a><span class="im">import</span> scipy.sparse</span>
<span id="cb5-4"><a href="MlAlgorithm.html#cb5-4"></a><span class="im">import</span> pickle</span>
<span id="cb5-5"><a href="MlAlgorithm.html#cb5-5"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb5-6"><a href="MlAlgorithm.html#cb5-6"></a></span>
<span id="cb5-7"><a href="MlAlgorithm.html#cb5-7"></a><span class="co">### simple example</span></span>
<span id="cb5-8"><a href="MlAlgorithm.html#cb5-8"></a><span class="co"># load file from text file, also binary buffer generated by xgboost</span></span>
<span id="cb5-9"><a href="MlAlgorithm.html#cb5-9"></a>dtrain <span class="op">=</span> xgb.DMatrix(<span class="st">&#39;../data/agaricus.txt.train&#39;</span>)</span>
<span id="cb5-10"><a href="MlAlgorithm.html#cb5-10"></a>dtest <span class="op">=</span> xgb.DMatrix(<span class="st">&#39;../data/agaricus.txt.test&#39;</span>)</span>
<span id="cb5-11"><a href="MlAlgorithm.html#cb5-11"></a></span>
<span id="cb5-12"><a href="MlAlgorithm.html#cb5-12"></a><span class="co"># specify parameters via map, definition are same as c++ version</span></span>
<span id="cb5-13"><a href="MlAlgorithm.html#cb5-13"></a>param <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>:<span class="dv">2</span>, <span class="st">&#39;eta&#39;</span>:<span class="dv">1</span>, <span class="st">&#39;silent&#39;</span>:<span class="dv">1</span>, <span class="st">&#39;objective&#39;</span>:<span class="st">&#39;binary:logistic&#39;</span>}</span>
<span id="cb5-14"><a href="MlAlgorithm.html#cb5-14"></a></span>
<span id="cb5-15"><a href="MlAlgorithm.html#cb5-15"></a><span class="co"># specify validations set to watch performance</span></span>
<span id="cb5-16"><a href="MlAlgorithm.html#cb5-16"></a>watchlist <span class="op">=</span> [(dtest, <span class="st">&#39;eval&#39;</span>), (dtrain, <span class="st">&#39;train&#39;</span>)]</span>
<span id="cb5-17"><a href="MlAlgorithm.html#cb5-17"></a>num_round <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-18"><a href="MlAlgorithm.html#cb5-18"></a>bst <span class="op">=</span> xgb.train(param, dtrain, num_round, watchlist)</span>
<span id="cb5-19"><a href="MlAlgorithm.html#cb5-19"></a></span>
<span id="cb5-20"><a href="MlAlgorithm.html#cb5-20"></a><span class="co"># this is prediction</span></span>
<span id="cb5-21"><a href="MlAlgorithm.html#cb5-21"></a>preds <span class="op">=</span> bst.predict(dtest)</span>
<span id="cb5-22"><a href="MlAlgorithm.html#cb5-22"></a>labels <span class="op">=</span> dtest.get_label()</span>
<span id="cb5-23"><a href="MlAlgorithm.html#cb5-23"></a><span class="bu">print</span>(<span class="st">&#39;error=</span><span class="sc">%f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(preds)) <span class="cf">if</span> <span class="bu">int</span>(preds[i] <span class="op">&gt;</span> <span class="fl">0.5</span>) <span class="op">!=</span> labels[i]) <span class="op">/</span> <span class="bu">float</span>(<span class="bu">len</span>(preds))))</span>
<span id="cb5-24"><a href="MlAlgorithm.html#cb5-24"></a>bst.save_model(<span class="st">&#39;0001.model&#39;</span>)</span>
<span id="cb5-25"><a href="MlAlgorithm.html#cb5-25"></a><span class="co"># dump model</span></span>
<span id="cb5-26"><a href="MlAlgorithm.html#cb5-26"></a>bst.dump_model(<span class="st">&#39;dump.raw.txt&#39;</span>)</span>
<span id="cb5-27"><a href="MlAlgorithm.html#cb5-27"></a><span class="co"># dump model with feature map</span></span>
<span id="cb5-28"><a href="MlAlgorithm.html#cb5-28"></a>bst.dump_model(<span class="st">&#39;dump.nice.txt&#39;</span>, <span class="st">&#39;../data/featmap.txt&#39;</span>)</span>
<span id="cb5-29"><a href="MlAlgorithm.html#cb5-29"></a></span>
<span id="cb5-30"><a href="MlAlgorithm.html#cb5-30"></a><span class="co"># save dmatrix into binary buffer</span></span>
<span id="cb5-31"><a href="MlAlgorithm.html#cb5-31"></a>dtest.save_binary(<span class="st">&#39;dtest.buffer&#39;</span>)</span>
<span id="cb5-32"><a href="MlAlgorithm.html#cb5-32"></a><span class="co"># save model</span></span>
<span id="cb5-33"><a href="MlAlgorithm.html#cb5-33"></a>bst.save_model(<span class="st">&#39;xgb.model&#39;</span>)</span>
<span id="cb5-34"><a href="MlAlgorithm.html#cb5-34"></a><span class="co"># load model and data in</span></span>
<span id="cb5-35"><a href="MlAlgorithm.html#cb5-35"></a>bst2 <span class="op">=</span> xgb.Booster(model_file<span class="op">=</span><span class="st">&#39;xgb.model&#39;</span>)</span>
<span id="cb5-36"><a href="MlAlgorithm.html#cb5-36"></a>dtest2 <span class="op">=</span> xgb.DMatrix(<span class="st">&#39;dtest.buffer&#39;</span>)</span>
<span id="cb5-37"><a href="MlAlgorithm.html#cb5-37"></a>preds2 <span class="op">=</span> bst2.predict(dtest2)</span>
<span id="cb5-38"><a href="MlAlgorithm.html#cb5-38"></a><span class="co"># assert they are the same</span></span>
<span id="cb5-39"><a href="MlAlgorithm.html#cb5-39"></a><span class="cf">assert</span> np.<span class="bu">sum</span>(np.<span class="bu">abs</span>(preds2 <span class="op">-</span> preds)) <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb5-40"><a href="MlAlgorithm.html#cb5-40"></a></span>
<span id="cb5-41"><a href="MlAlgorithm.html#cb5-41"></a><span class="co"># alternatively, you can pickle the booster</span></span>
<span id="cb5-42"><a href="MlAlgorithm.html#cb5-42"></a>pks <span class="op">=</span> pickle.dumps(bst2)</span>
<span id="cb5-43"><a href="MlAlgorithm.html#cb5-43"></a><span class="co"># load model and data in</span></span>
<span id="cb5-44"><a href="MlAlgorithm.html#cb5-44"></a>bst3 <span class="op">=</span> pickle.loads(pks)</span>
<span id="cb5-45"><a href="MlAlgorithm.html#cb5-45"></a>preds3 <span class="op">=</span> bst3.predict(dtest2)</span>
<span id="cb5-46"><a href="MlAlgorithm.html#cb5-46"></a><span class="co"># assert they are the same</span></span>
<span id="cb5-47"><a href="MlAlgorithm.html#cb5-47"></a><span class="cf">assert</span> np.<span class="bu">sum</span>(np.<span class="bu">abs</span>(preds3 <span class="op">-</span> preds)) <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb5-48"><a href="MlAlgorithm.html#cb5-48"></a></span>
<span id="cb5-49"><a href="MlAlgorithm.html#cb5-49"></a><span class="co">###</span></span>
<span id="cb5-50"><a href="MlAlgorithm.html#cb5-50"></a><span class="co"># build dmatrix from scipy.sparse</span></span>
<span id="cb5-51"><a href="MlAlgorithm.html#cb5-51"></a><span class="bu">print</span>(<span class="st">&#39;start running example of build DMatrix from scipy.sparse CSR Matrix&#39;</span>)</span>
<span id="cb5-52"><a href="MlAlgorithm.html#cb5-52"></a>labels <span class="op">=</span> []</span>
<span id="cb5-53"><a href="MlAlgorithm.html#cb5-53"></a>row <span class="op">=</span> []<span class="op">;</span> col <span class="op">=</span> []<span class="op">;</span> dat <span class="op">=</span> []</span>
<span id="cb5-54"><a href="MlAlgorithm.html#cb5-54"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-55"><a href="MlAlgorithm.html#cb5-55"></a><span class="cf">for</span> l <span class="kw">in</span> <span class="bu">open</span>(<span class="st">&#39;../data/agaricus.txt.train&#39;</span>):</span>
<span id="cb5-56"><a href="MlAlgorithm.html#cb5-56"></a>    arr <span class="op">=</span> l.split()</span>
<span id="cb5-57"><a href="MlAlgorithm.html#cb5-57"></a>    labels.append(<span class="bu">int</span>(arr[<span class="dv">0</span>]))</span>
<span id="cb5-58"><a href="MlAlgorithm.html#cb5-58"></a>    <span class="cf">for</span> it <span class="kw">in</span> arr[<span class="dv">1</span>:]:</span>
<span id="cb5-59"><a href="MlAlgorithm.html#cb5-59"></a>        k,v <span class="op">=</span> it.split(<span class="st">&#39;:&#39;</span>)</span>
<span id="cb5-60"><a href="MlAlgorithm.html#cb5-60"></a>        row.append(i)<span class="op">;</span> col.append(<span class="bu">int</span>(k))<span class="op">;</span> dat.append(<span class="bu">float</span>(v))</span>
<span id="cb5-61"><a href="MlAlgorithm.html#cb5-61"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-62"><a href="MlAlgorithm.html#cb5-62"></a>csr <span class="op">=</span> scipy.sparse.csr_matrix((dat, (row, col)))</span>
<span id="cb5-63"><a href="MlAlgorithm.html#cb5-63"></a>dtrain <span class="op">=</span> xgb.DMatrix(csr, label<span class="op">=</span>labels)</span>
<span id="cb5-64"><a href="MlAlgorithm.html#cb5-64"></a>watchlist <span class="op">=</span> [(dtest, <span class="st">&#39;eval&#39;</span>), (dtrain, <span class="st">&#39;train&#39;</span>)]</span>
<span id="cb5-65"><a href="MlAlgorithm.html#cb5-65"></a>bst <span class="op">=</span> xgb.train(param, dtrain, num_round, watchlist)</span>
<span id="cb5-66"><a href="MlAlgorithm.html#cb5-66"></a></span>
<span id="cb5-67"><a href="MlAlgorithm.html#cb5-67"></a><span class="bu">print</span>(<span class="st">&#39;start running example of build DMatrix from scipy.sparse CSC Matrix&#39;</span>)</span>
<span id="cb5-68"><a href="MlAlgorithm.html#cb5-68"></a><span class="co"># we can also construct from csc matrix</span></span>
<span id="cb5-69"><a href="MlAlgorithm.html#cb5-69"></a>csc <span class="op">=</span> scipy.sparse.csc_matrix((dat, (row, col)))</span>
<span id="cb5-70"><a href="MlAlgorithm.html#cb5-70"></a>dtrain <span class="op">=</span> xgb.DMatrix(csc, label<span class="op">=</span>labels)</span>
<span id="cb5-71"><a href="MlAlgorithm.html#cb5-71"></a>watchlist <span class="op">=</span> [(dtest, <span class="st">&#39;eval&#39;</span>), (dtrain, <span class="st">&#39;train&#39;</span>)]</span>
<span id="cb5-72"><a href="MlAlgorithm.html#cb5-72"></a>bst <span class="op">=</span> xgb.train(param, dtrain, num_round, watchlist)</span>
<span id="cb5-73"><a href="MlAlgorithm.html#cb5-73"></a></span>
<span id="cb5-74"><a href="MlAlgorithm.html#cb5-74"></a><span class="bu">print</span>(<span class="st">&#39;start running example of build DMatrix from numpy array&#39;</span>)</span>
<span id="cb5-75"><a href="MlAlgorithm.html#cb5-75"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: npymat is numpy array, we will convert it into scipy.sparse.csr_matrix in internal implementation</span></span>
<span id="cb5-76"><a href="MlAlgorithm.html#cb5-76"></a><span class="co"># then convert to DMatrix</span></span>
<span id="cb5-77"><a href="MlAlgorithm.html#cb5-77"></a>npymat <span class="op">=</span> csr.todense()</span>
<span id="cb5-78"><a href="MlAlgorithm.html#cb5-78"></a>dtrain <span class="op">=</span> xgb.DMatrix(npymat, label<span class="op">=</span>labels)</span>
<span id="cb5-79"><a href="MlAlgorithm.html#cb5-79"></a>watchlist <span class="op">=</span> [(dtest, <span class="st">&#39;eval&#39;</span>), (dtrain, <span class="st">&#39;train&#39;</span>)]</span>
<span id="cb5-80"><a href="MlAlgorithm.html#cb5-80"></a>bst <span class="op">=</span> xgb.train(param, dtrain, num_round, watchlist)</span></code></pre></div>
<p>The parameters below are from their webpage <a href="https://xgboost.readthedocs.io/en/latest/parameter.html#learning-task-parameters" class="uri">https://xgboost.readthedocs.io/en/latest/parameter.html#learning-task-parameters</a></p>
<div id="learning-task-parameters" class="section">
<h2>
Learning Task Parameters<a class="headerlink" href="#learning-task-parameters" title="Permalink to this headline">¶</a>
</h2>
<p>
Specify the learning task and the corresponding learning objective. The objective options are below:
</p>
<ul class="simple">
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">objective</span></code> [default=reg:squarederror]
</p>
<ul>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">reg:squarederror</span></code>: regression with squared loss.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">reg:squaredlogerror</span></code>: regression with squared log loss <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-1-Frame" class="MathJax" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span id="MathJax-Span-1" class="math" style="width: 17.593em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.163em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.587em, 1014.16em, 3.155em, -1000em); top: -2.621em; left: 0em;"><span id="MathJax-Span-2" class="mrow"><span id="MathJax-Span-3" class="mfrac"><span style="display: inline-block; position: relative; width: 0.474em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.353em, 1000.28em, 4.133em, -1000em); top: -4.386em; left: 50%; margin-left: -0.177em;"><span id="MathJax-Span-4" class="mn" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.34em, 4.133em, -1000em); top: -3.599em; left: 50%; margin-left: -0.177em;"><span id="MathJax-Span-5" class="mn" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(0.844em, 1000.47em, 1.21em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.474em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span id="MathJax-Span-6" class="mo" style="font-family: STIXGeneral;">[</span><span id="MathJax-Span-7" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑙</span><span id="MathJax-Span-8" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑜</span><span id="MathJax-Span-9" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑔</span><span id="MathJax-Span-10" class="mo" style="font-family: STIXGeneral;">(</span><span id="MathJax-Span-11" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑝</span><span id="MathJax-Span-12" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑟</span><span id="MathJax-Span-13" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑒</span><span id="MathJax-Span-14" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑑</span><span id="MathJax-Span-15" class="mo" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span id="MathJax-Span-16" class="mn" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span id="MathJax-Span-17" class="mo" style="font-family: STIXGeneral;">)</span><span id="MathJax-Span-18" class="mo" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span id="MathJax-Span-19" class="mi" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">𝑙</span><span id="MathJax-Span-20" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑜</span><span id="MathJax-Span-21" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑔</span><span id="MathJax-Span-22" class="mo" style="font-family: STIXGeneral;">(</span><span id="MathJax-Span-23" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑙</span><span id="MathJax-Span-24" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑎</span><span id="MathJax-Span-25" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑏</span><span id="MathJax-Span-26" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑒</span><span id="MathJax-Span-27" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑙</span><span id="MathJax-Span-28" class="mo" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span id="MathJax-Span-29" class="mn" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span id="MathJax-Span-30" class="mo" style="font-family: STIXGeneral;">)</span><span class="msubsup" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 0.762em; height: 0px;"><span style="position: absolute; clip: rect(3.169em, 1000.25em, 4.289em, -1000em); top: -3.982em; left: 0em;"><span class="mo" id="MathJax-Span-32" style="font-family: STIXGeneral;">]</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.345em; left: 0.333em;"><span id="MathJax-Span-33" class="mn" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.621em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.537em; border-left: 0px solid; width: 0px; height: 1.694em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup></math></span></span>
<script type="math/tex" id="MathJax-Element-1">\frac{1}{2}[log(pred + 1) - log(label + 1)]^2</script>
</span>. All input labels are required to be greater than -1. Also, see metric <code class="docutils literal notranslate"><span class="pre">rmsle</span></code> for possible issue with this objective.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">reg:logistic</span></code>: logistic regression
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">binary:logistic</span></code>: logistic regression for binary classification, output probability
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">binary:logitraw</span></code>: logistic regression for binary classification, output score before logistic transformation
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">binary:hinge</span></code>: hinge loss for binary classification. This makes predictions of 0 or 1, rather than producing probabilities.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">count:poisson</span></code> –poisson regression for count data, output mean of poisson distribution
</p>
<ul>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">max_delta_step</span></code> is set to 0.7 by default in poisson regression (used to safeguard optimization)
</p>
</li>
</ul>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">survival:cox</span></code>: Cox regression for right censored survival time data (negative values are considered right censored).
Note that predictions are returned on the hazard ratio scale (i.e., as HR = exp(marginal_prediction) in the proportional hazard function <code class="docutils literal notranslate"><span class="pre">h(t)</span> <span class="pre">=</span> <span class="pre">h0(t)</span> <span class="pre">*</span> <span class="pre">HR</span></code>).
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">multi:softmax</span></code>: set XGBoost to do multiclass classification using the softmax objective, you also need to set num_class(number of classes)
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">multi:softprob</span></code>: same as softmax, but output a vector of <code class="docutils literal notranslate"><span class="pre">ndata</span> <span class="pre"><em></span> <span class="pre">nclass</span></code>, which can be further reshaped to <code class="docutils literal notranslate"><span class="pre">ndata</span> <span class="pre"></em></span> <span class="pre">nclass</span></code> matrix. The result contains predicted probability of each data point belonging to each class.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">rank:pairwise</span></code>: Use LambdaMART to perform pairwise ranking where the pairwise loss is minimized
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">rank:ndcg</span></code>: Use LambdaMART to perform list-wise ranking where <a class="reference external" href="http://en.wikipedia.org/wiki/NDCG">Normalized Discounted Cumulative Gain (NDCG)</a> is maximized
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">rank:map</span></code>: Use LambdaMART to perform list-wise ranking where <a class="reference external" href="http://en.wikipedia.org/wiki/Mean_average_precision#Mean_average_precision">Mean Average Precision (MAP)</a> is maximized
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">reg:gamma</span></code>: gamma regression with log-link. Output is a mean of gamma distribution. It might be useful, e.g., for modeling insurance claims severity, or for any outcome that might be <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution#Applications">gamma-distributed</a>.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">reg:tweedie</span></code>: Tweedie regression with log-link. It might be useful, e.g., for modeling total loss in insurance, or for any outcome that might be <a class="reference external" href="https://en.wikipedia.org/wiki/Tweedie_distribution#Applications">Tweedie-distributed</a>.
</p>
</li>
</ul>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">base_score</span></code> [default=0.5]
</p>
<ul>
<li>
<p>
The initial prediction score of all instances, global bias
</p>
</li>
<li>
<p>
For sufficient number of iterations, changing this value will not have too much effect.
</p>
</li>
</ul>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">eval_metric</span></code> [default according to objective]
</p>
<ul>
<li>
<p>
Evaluation metrics for validation data, a default metric will be assigned according to objective (rmse for regression, and error for classification, mean average precision for ranking)
</p>
</li>
<li>
<p>
User can add multiple evaluation metrics. Python users: remember to pass the metrics in as list of parameters pairs instead of map, so that latter <code class="docutils literal notranslate"><span class="pre">eval_metric</span></code> won’t override previous one
</p>
</li>
<li>
<p>
The choices are listed below:
</p>
<ul>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">rmse</span></code>: <a class="reference external" href="http://en.wikipedia.org/wiki/Root_mean_square_error">root mean square error</a>
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">rmsle</span></code>: root mean square log error: <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-2-Frame" class="MathJax" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msqrt&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span id="MathJax-Span-34" class="math" style="width: 19.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.524em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.074em, 1015.52em, 3.223em, -1000em); top: -2.419em; left: 0em;"><span id="MathJax-Span-35" class="mrow"><span id="MathJax-Span-36" class="msqrt"><span style="display: inline-block; position: relative; width: 15.524em; height: 0px;"><span style="position: absolute; clip: rect(2.948em, 1014.44em, 4.499em, -1000em); top: -3.982em; left: 1.057em;"><span id="MathJax-Span-37" class="mrow"><span id="MathJax-Span-38" class="mfrac"><span style="display: inline-block; position: relative; width: 0.757em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.353em, 1000.28em, 4.133em, -1000em); top: -4.386em; left: 50%; margin-left: -0.177em;"><span id="MathJax-Span-39" class="mn" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.369em, 1000.64em, 4.133em, -1000em); top: -3.616em; left: 50%; margin-left: -0.319em;"><span id="MathJax-Span-40" class="mi" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">𝑁<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(0.844em, 1000.76em, 1.21em, -1000em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.757em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.058em;"></span></span></span></span><span id="MathJax-Span-41" class="mo" style="font-family: STIXGeneral;">[</span><span id="MathJax-Span-42" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑙</span><span id="MathJax-Span-43" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑜</span><span id="MathJax-Span-44" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑔</span><span id="MathJax-Span-45" class="mo" style="font-family: STIXGeneral;">(</span><span id="MathJax-Span-46" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑝</span><span id="MathJax-Span-47" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑟</span><span id="MathJax-Span-48" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑒</span><span id="MathJax-Span-49" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑑</span><span id="MathJax-Span-50" class="mo" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span id="MathJax-Span-51" class="mn" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span id="MathJax-Span-52" class="mo" style="font-family: STIXGeneral;">)</span><span id="MathJax-Span-53" class="mo" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span id="MathJax-Span-54" class="mi" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">𝑙</span><span id="MathJax-Span-55" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑜</span><span id="MathJax-Span-56" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑔</span><span id="MathJax-Span-57" class="mo" style="font-family: STIXGeneral;">(</span><span id="MathJax-Span-58" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑙</span><span id="MathJax-Span-59" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑎</span><span id="MathJax-Span-60" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑏</span><span id="MathJax-Span-61" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑒</span><span id="MathJax-Span-62" class="mi" style="font-family: STIXGeneral; font-style: italic;">𝑙</span><span id="MathJax-Span-63" class="mo" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span id="MathJax-Span-64" class="mn" style="font-family: STIXGeneral; padding-left: 0.25em;">1</span><span id="MathJax-Span-65" class="mo" style="font-family: STIXGeneral;">)</span><span class="msubsup" id="MathJax-Span-66"><span style="display: inline-block; position: relative; width: 0.762em; height: 0px;"><span style="position: absolute; clip: rect(3.169em, 1000.25em, 4.289em, -1000em); top: -3.982em; left: 0em;"><span class="mo" id="MathJax-Span-67" style="font-family: STIXGeneral;">]</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.271em; left: 0.333em;"><span id="MathJax-Span-68" class="mn" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.011em, 1014.47em, 3.363em, -1000em); top: -4.356em; left: 1.057em;"><span style="display: inline-block; position: relative; width: 14.467em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.982em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.982em; left: 13.967em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 0.426em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 0.878em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 1.329em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 1.78em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 2.232em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 2.683em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 3.134em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 3.586em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 4.037em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 4.488em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 4.94em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 5.391em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 5.842em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 6.294em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 6.745em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 7.197em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 7.648em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 8.099em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 8.551em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 9.002em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 9.453em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 9.905em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 10.356em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 10.807em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 11.259em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 11.71em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 12.161em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 12.613em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 13.064em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.982em; left: 13.515em;">‾<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(2.279em, 1001.09em, 4.428em, -1000em); top: -3.624em; left: 0em;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.415em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mfrac><mn>1</mn><mi>N</mi></mfrac><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup></msqrt></math></span></span>
<script type="math/tex" id="MathJax-Element-2">\sqrt{\frac{1}{N}[log(pred + 1) - log(label + 1)]^2}</script>
</span>. Default metric of <code class="docutils literal notranslate"><span class="pre">reg:squaredlogerror</span></code> objective. This metric reduces errors generated by outliers in dataset. But because <code class="docutils literal notranslate"><span class="pre">log</span></code> function is employed, <code class="docutils literal notranslate"><span class="pre">rmsle</span></code> might output <code class="docutils literal notranslate"><span class="pre">nan</span></code> when prediction value is less than -1. See <code class="docutils literal notranslate"><span class="pre">reg:squaredlogerror</span></code> for other requirements.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">mae</span></code>: <a class="reference external" href="https://en.wikipedia.org/wiki/Mean_absolute_error">mean absolute error</a>
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">logloss</span></code>: <a class="reference external" href="http://en.wikipedia.org/wiki/Log-likelihood">negative log-likelihood</a>
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">error</span></code>: Binary classification error rate. It is calculated as <code class="docutils literal notranslate"><span class="pre">#(wrong</span> <span class="pre">cases)/#(all</span> <span class="pre">cases)</span></code>. For the predictions, the evaluation will regard the instances with prediction value larger than 0.5 as positive instances, and the others as negative instances.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre"><a href="mailto:error@t" class="email">error@t</a></span></code>: a different than 0.5 binary classification threshold value could be specified by providing a numerical value through ‘t’.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">merror</span></code>: Multiclass classification error rate. It is calculated as <code class="docutils literal notranslate"><span class="pre">#(wrong</span> <span class="pre">cases)/#(all</span> <span class="pre">cases)</span></code>.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">mlogloss</span></code>: <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.log_loss.html">Multiclass logloss</a>.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">auc</span></code>: <a class="reference external" href="http://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_curve">Area under the curve</a>
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">aucpr</span></code>: <a class="reference external" href="https://en.wikipedia.org/wiki/Precision_and_recall">Area under the PR curve</a>
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">ndcg</span></code>: <a class="reference external" href="http://en.wikipedia.org/wiki/NDCG">Normalized Discounted Cumulative Gain</a>
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">map</span></code>: <a class="reference external" href="http://en.wikipedia.org/wiki/Mean_average_precision#Mean_average_precision">Mean Average Precision</a>
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre"><a href="mailto:ndcg@n" class="email">ndcg@n</a></span></code>, <code class="docutils literal notranslate"><span class="pre"><a href="mailto:map@n" class="email">map@n</a></span></code>: ‘n’ can be assigned as an integer to cut off the top positions in the lists for evaluation.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">ndcg-</span></code>, <code class="docutils literal notranslate"><span class="pre">map-</span></code>, <code class="docutils literal notranslate"><span class="pre"><a href="mailto:ndcg@n-" class="email">ndcg@n-</a></span></code>, <code class="docutils literal notranslate"><span class="pre"><a href="mailto:map@n-" class="email">map@n-</a></span></code>: In XGBoost, NDCG and MAP will evaluate the score of a list without any positive samples as 1. By adding “-” in the evaluation metric XGBoost will evaluate these score as 0 to be consistent under some conditions.
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">poisson-nloglik</span></code>: negative log-likelihood for Poisson regression
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">gamma-nloglik</span></code>: negative log-likelihood for gamma regression
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">cox-nloglik</span></code>: negative partial log-likelihood for Cox proportional hazards regression
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">gamma-deviance</span></code>: residual deviance for gamma regression
</p>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">tweedie-nloglik</span></code>: negative log-likelihood for Tweedie regression (at a specified value of the <code class="docutils literal notranslate"><span class="pre">tweedie_variance_power</span></code> parameter)
</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>
<code class="docutils literal notranslate"><span class="pre">seed</span></code> [default=0]
</p>
<ul>
<li>
<p>
Random number seed. This parameter is ignored in R package, use <cite>set.seed()</cite> instead.
</p>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="MlAlgoSvm" class="section level2">
<h2><span class="header-section-number">7.4</span> Support Vector Machine (SVM) TBD</h2>
<p>A good explanation of the theory behind SVMs is given in <span class="citation">(Tibshirani et al. <a href="#ref-9781461471370" role="doc-biblioref">2013</a>)</span></p>
<p>The support vector machine (SVM) is an extension of the support vector classifier that results from enlarging the feature space in a specific way, using kernels. We will now discuss this extension, the details of which are somewhat complex and are beyond the scope of this report. The main idea is to enlarge the feature space in order to accommodate a non-linear boundary between the classes. The kernel approach that we describe here is simply an efficient computational approach for enacting this idea.</p>
<p>The solution to the support vector classifier problem involves only the inner products of the observations (as opposed to the observations themselves). The inner product of two r-vectors <em>a</em> and <em>b</em> is defined as <span class="math inline">\(\langle a, b\rangle=\sum_{i=1}^{r} a_{i} b_{i}\)</span>;. Thus the inner product of two observations <span class="math inline">\(x_{i}, x_{i^{\prime}}\)</span> is given by</p>
<p><span class="math display" id="eq:9-17">\[\begin{equation} 
\left\langle x_{i}, x_{i^{\prime}}\right\rangle=\sum_{j=1}^{p} x_{i j} x_{i^{\prime} j}
  \tag{7.1}
\end{equation}\]</span></p>
<p>It can be shown that<br />
- The linear support vector classifier can be represented as:</p>
<p><span class="math display" id="eq:9-18">\[\begin{equation} 
f(x)=\beta_{0}+\sum_{i=1}^{n} \alpha_{i}\left\langle x, x_{i}\right\rangle
  \tag{7.2}
\end{equation}\]</span></p>
<p>where there are <em>n</em> parameters <span class="math inline">\(\alpha_{i}, \quad i=1, \dots, n\)</span>, one per training observation.</p>
<ul>
<li>To estimate the parameters <span class="math inline">\(\alpha_{1}, \ldots, \alpha_{n} \text { and } \beta_{0}\)</span>, all we need are the <span class="math inline">\(\left( \begin{array}{l}{n} \\ {2}\end{array}\right)\)</span> inner products <span class="math inline">\(\left\langle x_{i}, x_{i^{\prime}}\right\rangle\)</span> between all pairs of training observations. The notation <span class="math inline">\(\left( \begin{array}{c}{n} \\ {2}\end{array}\right)\)</span> means <span class="math inline">\(n(n-1) / 2\)</span> and gives the number of pairs among a set of <span class="math inline">\(n\)</span> items.</li>
</ul>
<p>Notice that in <a href="MlAlgorithm.html#eq:9-18">(7.2)</a>, in order to evaluate the function f(x), we need to compute the inner product between the new point <em>x</em> and each of the training points <span class="math inline">\(x_i\)</span>. However, it turns out that <span class="math inline">\(α_i\)</span> is nonzero only for the support vectors in the solution—that is, if a training observation is not a support vector, then its <span class="math inline">\(α_i\)</span> equals zero. So if <em>S</em> is the collection of indices of these support points, we can rewrite any solution function of the form <a href="MlAlgorithm.html#eq:9-18">(7.2)</a> as</p>
<p><span class="math display" id="eq:9-19">\[\begin{equation} 
f(x)=\beta_{0}+\sum_{i \in \mathcal{S}} \alpha_{i}\left\langle x, x_{i}\right\rangle
  \tag{7.3}
\end{equation}\]</span>
which typically involves far fewer terms than in <a href="MlAlgorithm.html#eq:9-18">(7.2)</a></p>
<div id="kernels" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Kernels</h3>
<p>To summarize, in representing the linear classifier <span class="math inline">\(f (x)\)</span>, and in computing its coefficients, all we need are inner products. Now suppose that every time the inner product <a href="MlAlgorithm.html#eq:9-17">(7.1)</a> appears in the representation <a href="MlAlgorithm.html#eq:9-18">(7.2)</a>, or in a calculation of the solution for the support vector classifier, we replace it with a generalization of the inner product of the form</p>
<p><span class="math display" id="eq:9-20">\[\begin{equation} 
K\left(x_{i}, x_{i^{\prime}}\right)  
  \tag{7.4}
\end{equation}\]</span></p>
<p>where <em>K</em> is some function that we will refer to as a kernel. A kernel is a function that quantifies the similarity of two observations. For instance, we could simply take</p>
<p><span class="math display" id="eq:9-21">\[\begin{equation} 
K\left(x_{i}, x_{i^{\prime}}\right)=\sum_{j=1}^{p} x_{i j} x_{i^{\prime} j}
\tag{7.5}
\end{equation}\]</span></p>
<p>which would just give us back the support vector classifier. Equation <a href="MlAlgorithm.html#eq:9-21">(7.5)</a> is known as a linear kernel because the support vector classifier is linear in the features; the linear kernel essentially quantifies the similarity of a pair of observations using Pearson (standard) correlation.</p>
<div id="polynomial-kernel" class="section level4">
<h4><span class="header-section-number">7.4.1.1</span> Polynomial Kernel</h4>
<p>But one could instead choose another form for <a href="MlAlgorithm.html#eq:9-20">(7.4)</a>. For instance, one could replace every instance of <span class="math inline">\(\sum_{j=1}^{p} x_{i j} x_{i^{\prime} j}\)</span> with the quantity</p>
<p><span class="math display" id="eq:9-22">\[\begin{equation} 
K\left(x_{i}, x_{i^{\prime}}\right)=\left(1+\sum_{j=1}^{p} x_{i j} x_{i^{\prime} j}\right)^{d}
  \tag{7.6}
\end{equation}\]</span></p>
<p>This is known as a polynomial kernel of degree <em>d</em>, where <em>d</em> is a positive integer. Using such a kernel with <em>d</em> &gt; 1, instead of the standard linear kernel <a href="MlAlgorithm.html#eq:9-21">(7.5)</a>, in the support vector classifier algorithm leads to a much more flexible decision boundary. It essentially amounts to fitting a support vector classifier in a higher-dimensional space involving polynomials of degree <em>d</em>, rather than in the original feature space. When the support vector classifier is combined with a non-linear kernel such as <a href="MlAlgorithm.html#eq:9-22">(7.6)</a>, the resulting classifier is known as a support vector machine. Note that in this case the (non-linear) function has the form</p>
<p><span class="math display" id="eq:9-23">\[\begin{equation} 
f(x)=\beta_{0}+\sum_{i \in \mathcal{S}} \alpha_{i} K\left(x, x_{i}\right)
  \tag{7.7}
\end{equation}\]</span></p>
<p>The polynomial kernel shown in <a href="MlAlgorithm.html#eq:9-22">(7.6)</a> is one example of a possible non-linear kernel, but alternatives abound.</p>
</div>
<div id="radial-kernel" class="section level4">
<h4><span class="header-section-number">7.4.1.2</span> Radial Kernel</h4>
<p>Another popular choice is the <em>radial kernel</em>, which takes the form</p>
<p><span class="math display" id="eq:9-24">\[\begin{equation} 
K\left(x_{i}, x_{i^{\prime}}\right)=\exp \left(-\gamma \sum_{j=1}^{p}\left(x_{i j}-x_{i^{\prime} j}\right)^{2}\right)
  \tag{7.8}
\end{equation}\]</span></p>
<p>In <a href="MlAlgorithm.html#eq:9-24">(7.8)</a>, γ is a positive constant.</p>
<p>How does the radial kernel <a href="MlAlgorithm.html#eq:9-24">(7.8)</a> actually work? If a given test observation <span class="math inline">\(x^{*}=\left(x_{1}^{*} \ldots x_{p}^{*}\right)^{T}\)</span> is far from a training observation <span class="math inline">\(x_i\)</span> in terms of Euclidean distance, then <span class="math inline">\(\sum_{j=1}^{p}\left(x_{j}^{*}-x_{i j}\right)^{2}\)</span> will be large, and so <span class="math inline">\(K\left(x_{i}, x_{i^{\prime}}\right)={\exp \left(-\gamma \sum_{j=1}^{p}\left(x_{j}^{*}-x_{i j}\right)^{2}\right)}\)</span> will be very tiny. This means that in <a href="MlAlgorithm.html#eq:9-23">(7.7)</a>, <span class="math inline">\(x_{i}\)</span> will play virtually no role in <span class="math inline">\(f\left(x^{*}\right)\)</span>. Recall that the predicted class label for the test observation <span class="math inline">\(x^{*}\)</span> is based on the sign of <span class="math inline">\(f\left(x^{*}\right)\)</span>. In other words, training observations that are far from <span class="math inline">\(x^{*}\)</span> will play essentially no role in the predicted class label for <span class="math inline">\(x^{*}\)</span>. This means that the radial kernel has very local behaviour, in the sense that only nearby training observations have an effect on the class label of a test observation.
What is the advantage of using a kernel rather than simply enlarging the feature space using functions of the original features? One
advantage is computational, and it amounts to the fact that using kernels, one need only compute <span class="math inline">\(K\left(x_{i}, x_{i^{\prime}}\right)\)</span> for <span class="math inline">\(\left( \begin{array}{l}{n} \\ {2}\end{array}\right)\)</span> distinct pairs <span class="math inline">\(i\)</span>, <span class="math inline">\(i^{\prime}\)</span>.This can be
done without explicitly working in the enlarged feature space. This is im- portant because in many applications of SVMs, the enlarged feature space is so large that computations are intractable. For some kernels, such as the radial kernel <a href="MlAlgorithm.html#eq:9-24">(7.8)</a>, the feature space is <em>implicit</em> and infinite-dimensional, so we could never do the computations there anyway!</p>
</div>
</div>
<div id="python-example-for-svm" class="section level3">
<h3><span class="header-section-number">7.4.2</span> Python example for SVM</h3>
<p>Two examples are given, both take images and classify them.</p>
<div id="svm-face-recognition" class="section level4">
<h4><span class="header-section-number">7.4.2.1</span> SVM face recognition</h4>
<p>The following example is given at <a href="https://scikit-learn.org/stable/auto_examples/applications/plot_face_recognition.html#sphx-glr-auto-examples-applications-plot-face-recognition-py">scikit-learn.org</a></p>
<p>It uses a SVM with</p>
<ul>
<li>rbf kernel</li>
<li>grid search for hyper parameter
<ul>
<li>C</li>
<li>gamma</li>
<li>using <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">scikit-learn GridSearchCV</a></li>
</ul></li>
<li>PCA to create input features
<ul>
<li>150 dimensions</li>
</ul></li>
</ul>
<p>See below some examples of the resulting classification of the algorithm</p>
<p><img src="images/svmFaces.png" style="width:60.0%" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb6-1"><a href="MlAlgorithm.html#cb6-1"></a>Total dataset size:</span>
<span id="cb6-2"><a href="MlAlgorithm.html#cb6-2"></a>n_samples: 1288</span>
<span id="cb6-3"><a href="MlAlgorithm.html#cb6-3"></a>n_features: 1850</span>
<span id="cb6-4"><a href="MlAlgorithm.html#cb6-4"></a>n_classes: 7</span>
<span id="cb6-5"><a href="MlAlgorithm.html#cb6-5"></a>Extracting the top 150 eigenfaces from 966 faces</span>
<span id="cb6-6"><a href="MlAlgorithm.html#cb6-6"></a>done in 0.320s</span>
<span id="cb6-7"><a href="MlAlgorithm.html#cb6-7"></a>Projecting the input data on the eigenfaces orthonormal basis</span>
<span id="cb6-8"><a href="MlAlgorithm.html#cb6-8"></a>done in 0.013s</span>
<span id="cb6-9"><a href="MlAlgorithm.html#cb6-9"></a>Fitting the classifier to the training set</span>
<span id="cb6-10"><a href="MlAlgorithm.html#cb6-10"></a>done in 28.379s</span>
<span id="cb6-11"><a href="MlAlgorithm.html#cb6-11"></a>Best estimator found by grid search:</span>
<span id="cb6-12"><a href="MlAlgorithm.html#cb6-12"></a>SVC(C=1000.0, break_ties=False, cache_size=200, class_weight=&#39;balanced&#39;,</span>
<span id="cb6-13"><a href="MlAlgorithm.html#cb6-13"></a><span class="bn">    coef0=0.0, decision_function_shape=&#39;ovr&#39;, degree=3, gamma=0.005,</span></span>
<span id="cb6-14"><a href="MlAlgorithm.html#cb6-14"></a><span class="bn">    kernel=&#39;rbf&#39;, max_iter=-1, probability=False, random_state=None,</span></span>
<span id="cb6-15"><a href="MlAlgorithm.html#cb6-15"></a><span class="bn">    shrinking=True, tol=0.001, verbose=False)</span></span>
<span id="cb6-16"><a href="MlAlgorithm.html#cb6-16"></a>Predicting people&#39;s names on the test set</span>
<span id="cb6-17"><a href="MlAlgorithm.html#cb6-17"></a>done in 0.045s</span>
<span id="cb6-18"><a href="MlAlgorithm.html#cb6-18"></a><span class="bn">                   precision    recall  f1-score   support</span></span>
<span id="cb6-19"><a href="MlAlgorithm.html#cb6-19"></a></span>
<span id="cb6-20"><a href="MlAlgorithm.html#cb6-20"></a><span class="bn">     Ariel Sharon       0.88      0.54      0.67        13</span></span>
<span id="cb6-21"><a href="MlAlgorithm.html#cb6-21"></a><span class="bn">     Colin Powell       0.80      0.87      0.83        60</span></span>
<span id="cb6-22"><a href="MlAlgorithm.html#cb6-22"></a>  Donald Rumsfeld       0.94      0.63      0.76        27</span>
<span id="cb6-23"><a href="MlAlgorithm.html#cb6-23"></a><span class="bn">    George W Bush       0.83      0.98      0.90       146</span></span>
<span id="cb6-24"><a href="MlAlgorithm.html#cb6-24"></a>Gerhard Schroeder       0.91      0.80      0.85        25</span>
<span id="cb6-25"><a href="MlAlgorithm.html#cb6-25"></a><span class="bn">      Hugo Chavez       1.00      0.53      0.70        15</span></span>
<span id="cb6-26"><a href="MlAlgorithm.html#cb6-26"></a><span class="bn">       Tony Blair       0.96      0.75      0.84        36</span></span>
<span id="cb6-27"><a href="MlAlgorithm.html#cb6-27"></a></span>
<span id="cb6-28"><a href="MlAlgorithm.html#cb6-28"></a><span class="bn">         accuracy                           0.85       322</span></span>
<span id="cb6-29"><a href="MlAlgorithm.html#cb6-29"></a><span class="bn">        macro avg       0.90      0.73      0.79       322</span></span>
<span id="cb6-30"><a href="MlAlgorithm.html#cb6-30"></a><span class="bn">     weighted avg       0.86      0.85      0.84       322</span></span>
<span id="cb6-31"><a href="MlAlgorithm.html#cb6-31"></a></span>
<span id="cb6-32"><a href="MlAlgorithm.html#cb6-32"></a></span>
<span id="cb6-33"><a href="MlAlgorithm.html#cb6-33"></a>Confusion matrix</span>
<span id="cb6-34"><a href="MlAlgorithm.html#cb6-34"></a></span>
<span id="cb6-35"><a href="MlAlgorithm.html#cb6-35"></a>[[  7   1   0   5   0   0   0]</span>
<span id="cb6-36"><a href="MlAlgorithm.html#cb6-36"></a> [  1  52   0   7   0   0   0]</span>
<span id="cb6-37"><a href="MlAlgorithm.html#cb6-37"></a> [  0   3  17   7   0   0   0]</span>
<span id="cb6-38"><a href="MlAlgorithm.html#cb6-38"></a> [  0   3   0 143   0   0   0]</span>
<span id="cb6-39"><a href="MlAlgorithm.html#cb6-39"></a> [  0   1   0   3  20   0   1]</span>
<span id="cb6-40"><a href="MlAlgorithm.html#cb6-40"></a> [  0   4   0   2   1   8   0]</span>
<span id="cb6-41"><a href="MlAlgorithm.html#cb6-41"></a> [  0   1   1   6   1   0  27]]</span></code></pre></div>
<p>The python code is given below</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="MlAlgorithm.html#cb7-1"></a><span class="im">from</span> time <span class="im">import</span> time</span>
<span id="cb7-2"><a href="MlAlgorithm.html#cb7-2"></a><span class="im">import</span> logging</span>
<span id="cb7-3"><a href="MlAlgorithm.html#cb7-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-4"><a href="MlAlgorithm.html#cb7-4"></a></span>
<span id="cb7-5"><a href="MlAlgorithm.html#cb7-5"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb7-6"><a href="MlAlgorithm.html#cb7-6"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb7-7"><a href="MlAlgorithm.html#cb7-7"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_lfw_people</span>
<span id="cb7-8"><a href="MlAlgorithm.html#cb7-8"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb7-9"><a href="MlAlgorithm.html#cb7-9"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb7-10"><a href="MlAlgorithm.html#cb7-10"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb7-11"><a href="MlAlgorithm.html#cb7-11"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb7-12"><a href="MlAlgorithm.html#cb7-12"></a></span>
<span id="cb7-13"><a href="MlAlgorithm.html#cb7-13"></a></span>
<span id="cb7-14"><a href="MlAlgorithm.html#cb7-14"></a><span class="bu">print</span>(__doc__)</span>
<span id="cb7-15"><a href="MlAlgorithm.html#cb7-15"></a></span>
<span id="cb7-16"><a href="MlAlgorithm.html#cb7-16"></a><span class="co"># Display progress logs on stdout</span></span>
<span id="cb7-17"><a href="MlAlgorithm.html#cb7-17"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> </span><span class="sc">%(message)s</span><span class="st">&#39;</span>)</span>
<span id="cb7-18"><a href="MlAlgorithm.html#cb7-18"></a></span>
<span id="cb7-19"><a href="MlAlgorithm.html#cb7-19"></a></span>
<span id="cb7-20"><a href="MlAlgorithm.html#cb7-20"></a><span class="co"># #############################################################################</span></span>
<span id="cb7-21"><a href="MlAlgorithm.html#cb7-21"></a><span class="co"># Download the data, if not already on disk and load it as numpy arrays</span></span>
<span id="cb7-22"><a href="MlAlgorithm.html#cb7-22"></a></span>
<span id="cb7-23"><a href="MlAlgorithm.html#cb7-23"></a>lfw_people <span class="op">=</span> fetch_lfw_people(min_faces_per_person<span class="op">=</span><span class="dv">70</span>, resize<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb7-24"><a href="MlAlgorithm.html#cb7-24"></a></span>
<span id="cb7-25"><a href="MlAlgorithm.html#cb7-25"></a><span class="co"># introspect the images arrays to find the shapes (for plotting)</span></span>
<span id="cb7-26"><a href="MlAlgorithm.html#cb7-26"></a>n_samples, h, w <span class="op">=</span> lfw_people.images.shape</span>
<span id="cb7-27"><a href="MlAlgorithm.html#cb7-27"></a></span>
<span id="cb7-28"><a href="MlAlgorithm.html#cb7-28"></a><span class="co"># for machine learning we use the 2 data directly (as relative pixel</span></span>
<span id="cb7-29"><a href="MlAlgorithm.html#cb7-29"></a><span class="co"># positions info is ignored by this model)</span></span>
<span id="cb7-30"><a href="MlAlgorithm.html#cb7-30"></a>X <span class="op">=</span> lfw_people.data</span>
<span id="cb7-31"><a href="MlAlgorithm.html#cb7-31"></a>n_features <span class="op">=</span> X.shape[<span class="dv">1</span>]</span>
<span id="cb7-32"><a href="MlAlgorithm.html#cb7-32"></a></span>
<span id="cb7-33"><a href="MlAlgorithm.html#cb7-33"></a><span class="co"># the label to predict is the id of the person</span></span>
<span id="cb7-34"><a href="MlAlgorithm.html#cb7-34"></a>y <span class="op">=</span> lfw_people.target</span>
<span id="cb7-35"><a href="MlAlgorithm.html#cb7-35"></a>target_names <span class="op">=</span> lfw_people.target_names</span>
<span id="cb7-36"><a href="MlAlgorithm.html#cb7-36"></a>n_classes <span class="op">=</span> target_names.shape[<span class="dv">0</span>]</span>
<span id="cb7-37"><a href="MlAlgorithm.html#cb7-37"></a></span>
<span id="cb7-38"><a href="MlAlgorithm.html#cb7-38"></a><span class="bu">print</span>(<span class="st">&quot;Total dataset size:&quot;</span>)</span>
<span id="cb7-39"><a href="MlAlgorithm.html#cb7-39"></a><span class="bu">print</span>(<span class="st">&quot;n_samples: </span><span class="sc">%d</span><span class="st">&quot;</span> <span class="op">%</span> n_samples)</span>
<span id="cb7-40"><a href="MlAlgorithm.html#cb7-40"></a><span class="bu">print</span>(<span class="st">&quot;n_features: </span><span class="sc">%d</span><span class="st">&quot;</span> <span class="op">%</span> n_features)</span>
<span id="cb7-41"><a href="MlAlgorithm.html#cb7-41"></a><span class="bu">print</span>(<span class="st">&quot;n_classes: </span><span class="sc">%d</span><span class="st">&quot;</span> <span class="op">%</span> n_classes)</span>
<span id="cb7-42"><a href="MlAlgorithm.html#cb7-42"></a></span>
<span id="cb7-43"><a href="MlAlgorithm.html#cb7-43"></a></span>
<span id="cb7-44"><a href="MlAlgorithm.html#cb7-44"></a><span class="co"># #############################################################################</span></span>
<span id="cb7-45"><a href="MlAlgorithm.html#cb7-45"></a><span class="co"># Split into a training set and a test set using a stratified k fold</span></span>
<span id="cb7-46"><a href="MlAlgorithm.html#cb7-46"></a></span>
<span id="cb7-47"><a href="MlAlgorithm.html#cb7-47"></a><span class="co"># split into a training and testing set</span></span>
<span id="cb7-48"><a href="MlAlgorithm.html#cb7-48"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb7-49"><a href="MlAlgorithm.html#cb7-49"></a>    X, y, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb7-50"><a href="MlAlgorithm.html#cb7-50"></a></span>
<span id="cb7-51"><a href="MlAlgorithm.html#cb7-51"></a></span>
<span id="cb7-52"><a href="MlAlgorithm.html#cb7-52"></a><span class="co"># #############################################################################</span></span>
<span id="cb7-53"><a href="MlAlgorithm.html#cb7-53"></a><span class="co"># Compute a PCA (eigenfaces) on the face dataset (treated as unlabeled</span></span>
<span id="cb7-54"><a href="MlAlgorithm.html#cb7-54"></a><span class="co"># dataset): unsupervised feature extraction / dimensionality reduction</span></span>
<span id="cb7-55"><a href="MlAlgorithm.html#cb7-55"></a>n_components <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb7-56"><a href="MlAlgorithm.html#cb7-56"></a></span>
<span id="cb7-57"><a href="MlAlgorithm.html#cb7-57"></a><span class="bu">print</span>(<span class="st">&quot;Extracting the top </span><span class="sc">%d</span><span class="st"> eigenfaces from </span><span class="sc">%d</span><span class="st"> faces&quot;</span></span>
<span id="cb7-58"><a href="MlAlgorithm.html#cb7-58"></a>      <span class="op">%</span> (n_components, X_train.shape[<span class="dv">0</span>]))</span>
<span id="cb7-59"><a href="MlAlgorithm.html#cb7-59"></a>t0 <span class="op">=</span> time()</span>
<span id="cb7-60"><a href="MlAlgorithm.html#cb7-60"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span>n_components, svd_solver<span class="op">=</span><span class="st">&#39;randomized&#39;</span>,</span>
<span id="cb7-61"><a href="MlAlgorithm.html#cb7-61"></a>          whiten<span class="op">=</span><span class="va">True</span>).fit(X_train)</span>
<span id="cb7-62"><a href="MlAlgorithm.html#cb7-62"></a><span class="bu">print</span>(<span class="st">&quot;done in </span><span class="sc">%0.3f</span><span class="st">s&quot;</span> <span class="op">%</span> (time() <span class="op">-</span> t0))</span>
<span id="cb7-63"><a href="MlAlgorithm.html#cb7-63"></a></span>
<span id="cb7-64"><a href="MlAlgorithm.html#cb7-64"></a>eigenfaces <span class="op">=</span> pca.components_.reshape((n_components, h, w))</span>
<span id="cb7-65"><a href="MlAlgorithm.html#cb7-65"></a></span>
<span id="cb7-66"><a href="MlAlgorithm.html#cb7-66"></a><span class="bu">print</span>(<span class="st">&quot;Projecting the input data on the eigenfaces orthonormal basis&quot;</span>)</span>
<span id="cb7-67"><a href="MlAlgorithm.html#cb7-67"></a>t0 <span class="op">=</span> time()</span>
<span id="cb7-68"><a href="MlAlgorithm.html#cb7-68"></a>X_train_pca <span class="op">=</span> pca.transform(X_train)</span>
<span id="cb7-69"><a href="MlAlgorithm.html#cb7-69"></a>X_test_pca <span class="op">=</span> pca.transform(X_test)</span>
<span id="cb7-70"><a href="MlAlgorithm.html#cb7-70"></a><span class="bu">print</span>(<span class="st">&quot;done in </span><span class="sc">%0.3f</span><span class="st">s&quot;</span> <span class="op">%</span> (time() <span class="op">-</span> t0))</span>
<span id="cb7-71"><a href="MlAlgorithm.html#cb7-71"></a></span>
<span id="cb7-72"><a href="MlAlgorithm.html#cb7-72"></a></span>
<span id="cb7-73"><a href="MlAlgorithm.html#cb7-73"></a><span class="co"># #############################################################################</span></span>
<span id="cb7-74"><a href="MlAlgorithm.html#cb7-74"></a><span class="co"># Train a SVM classification model</span></span>
<span id="cb7-75"><a href="MlAlgorithm.html#cb7-75"></a></span>
<span id="cb7-76"><a href="MlAlgorithm.html#cb7-76"></a><span class="bu">print</span>(<span class="st">&quot;Fitting the classifier to the training set&quot;</span>)</span>
<span id="cb7-77"><a href="MlAlgorithm.html#cb7-77"></a>t0 <span class="op">=</span> time()</span>
<span id="cb7-78"><a href="MlAlgorithm.html#cb7-78"></a>param_grid <span class="op">=</span> {<span class="st">&#39;C&#39;</span>: [<span class="fl">1e3</span>, <span class="fl">5e3</span>, <span class="fl">1e4</span>, <span class="fl">5e4</span>, <span class="fl">1e5</span>],</span>
<span id="cb7-79"><a href="MlAlgorithm.html#cb7-79"></a>              <span class="st">&#39;gamma&#39;</span>: [<span class="fl">0.0001</span>, <span class="fl">0.0005</span>, <span class="fl">0.001</span>, <span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>], }</span>
<span id="cb7-80"><a href="MlAlgorithm.html#cb7-80"></a>clf <span class="op">=</span> GridSearchCV(</span>
<span id="cb7-81"><a href="MlAlgorithm.html#cb7-81"></a>    SVC(kernel<span class="op">=</span><span class="st">&#39;rbf&#39;</span>, class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>), param_grid</span>
<span id="cb7-82"><a href="MlAlgorithm.html#cb7-82"></a>)</span>
<span id="cb7-83"><a href="MlAlgorithm.html#cb7-83"></a>clf <span class="op">=</span> clf.fit(X_train_pca, y_train)</span>
<span id="cb7-84"><a href="MlAlgorithm.html#cb7-84"></a><span class="bu">print</span>(<span class="st">&quot;done in </span><span class="sc">%0.3f</span><span class="st">s&quot;</span> <span class="op">%</span> (time() <span class="op">-</span> t0))</span>
<span id="cb7-85"><a href="MlAlgorithm.html#cb7-85"></a><span class="bu">print</span>(<span class="st">&quot;Best estimator found by grid search:&quot;</span>)</span>
<span id="cb7-86"><a href="MlAlgorithm.html#cb7-86"></a><span class="bu">print</span>(clf.best_estimator_)</span>
<span id="cb7-87"><a href="MlAlgorithm.html#cb7-87"></a></span>
<span id="cb7-88"><a href="MlAlgorithm.html#cb7-88"></a></span>
<span id="cb7-89"><a href="MlAlgorithm.html#cb7-89"></a><span class="co"># #############################################################################</span></span>
<span id="cb7-90"><a href="MlAlgorithm.html#cb7-90"></a><span class="co"># Quantitative evaluation of the model quality on the test set</span></span>
<span id="cb7-91"><a href="MlAlgorithm.html#cb7-91"></a></span>
<span id="cb7-92"><a href="MlAlgorithm.html#cb7-92"></a><span class="bu">print</span>(<span class="st">&quot;Predicting people&#39;s names on the test set&quot;</span>)</span>
<span id="cb7-93"><a href="MlAlgorithm.html#cb7-93"></a>t0 <span class="op">=</span> time()</span>
<span id="cb7-94"><a href="MlAlgorithm.html#cb7-94"></a>y_pred <span class="op">=</span> clf.predict(X_test_pca)</span>
<span id="cb7-95"><a href="MlAlgorithm.html#cb7-95"></a><span class="bu">print</span>(<span class="st">&quot;done in </span><span class="sc">%0.3f</span><span class="st">s&quot;</span> <span class="op">%</span> (time() <span class="op">-</span> t0))</span>
<span id="cb7-96"><a href="MlAlgorithm.html#cb7-96"></a></span>
<span id="cb7-97"><a href="MlAlgorithm.html#cb7-97"></a><span class="bu">print</span>(classification_report(y_test, y_pred, target_names<span class="op">=</span>target_names))</span>
<span id="cb7-98"><a href="MlAlgorithm.html#cb7-98"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred, labels<span class="op">=</span><span class="bu">range</span>(n_classes)))</span>
<span id="cb7-99"><a href="MlAlgorithm.html#cb7-99"></a></span>
<span id="cb7-100"><a href="MlAlgorithm.html#cb7-100"></a></span>
<span id="cb7-101"><a href="MlAlgorithm.html#cb7-101"></a><span class="co"># #############################################################################</span></span>
<span id="cb7-102"><a href="MlAlgorithm.html#cb7-102"></a><span class="co"># Qualitative evaluation of the predictions using matplotlib</span></span>
<span id="cb7-103"><a href="MlAlgorithm.html#cb7-103"></a></span>
<span id="cb7-104"><a href="MlAlgorithm.html#cb7-104"></a><span class="kw">def</span> plot_gallery(images, titles, h, w, n_row<span class="op">=</span><span class="dv">3</span>, n_col<span class="op">=</span><span class="dv">4</span>):</span>
<span id="cb7-105"><a href="MlAlgorithm.html#cb7-105"></a>    <span class="co">&quot;&quot;&quot;Helper function to plot a gallery of portraits&quot;&quot;&quot;</span></span>
<span id="cb7-106"><a href="MlAlgorithm.html#cb7-106"></a>    plt.figure(figsize<span class="op">=</span>(<span class="fl">1.8</span> <span class="op">*</span> n_col, <span class="fl">2.4</span> <span class="op">*</span> n_row))</span>
<span id="cb7-107"><a href="MlAlgorithm.html#cb7-107"></a>    plt.subplots_adjust(bottom<span class="op">=</span><span class="dv">0</span>, left<span class="op">=</span>.<span class="dv">01</span>, right<span class="op">=</span>.<span class="dv">99</span>, top<span class="op">=</span>.<span class="dv">90</span>, hspace<span class="op">=</span>.<span class="dv">35</span>)</span>
<span id="cb7-108"><a href="MlAlgorithm.html#cb7-108"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_row <span class="op">*</span> n_col):</span>
<span id="cb7-109"><a href="MlAlgorithm.html#cb7-109"></a>        plt.subplot(n_row, n_col, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb7-110"><a href="MlAlgorithm.html#cb7-110"></a>        plt.imshow(images[i].reshape((h, w)), cmap<span class="op">=</span>plt.cm.gray)</span>
<span id="cb7-111"><a href="MlAlgorithm.html#cb7-111"></a>        plt.title(titles[i], size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb7-112"><a href="MlAlgorithm.html#cb7-112"></a>        plt.xticks(())</span>
<span id="cb7-113"><a href="MlAlgorithm.html#cb7-113"></a>        plt.yticks(())</span>
<span id="cb7-114"><a href="MlAlgorithm.html#cb7-114"></a></span>
<span id="cb7-115"><a href="MlAlgorithm.html#cb7-115"></a></span>
<span id="cb7-116"><a href="MlAlgorithm.html#cb7-116"></a><span class="co"># plot the result of the prediction on a portion of the test set</span></span>
<span id="cb7-117"><a href="MlAlgorithm.html#cb7-117"></a></span>
<span id="cb7-118"><a href="MlAlgorithm.html#cb7-118"></a><span class="kw">def</span> title(y_pred, y_test, target_names, i):</span>
<span id="cb7-119"><a href="MlAlgorithm.html#cb7-119"></a>    pred_name <span class="op">=</span> target_names[y_pred[i]].rsplit(<span class="st">&#39; &#39;</span>, <span class="dv">1</span>)[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb7-120"><a href="MlAlgorithm.html#cb7-120"></a>    true_name <span class="op">=</span> target_names[y_test[i]].rsplit(<span class="st">&#39; &#39;</span>, <span class="dv">1</span>)[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb7-121"><a href="MlAlgorithm.html#cb7-121"></a>    <span class="cf">return</span> <span class="st">&#39;predicted: </span><span class="sc">%s</span><span class="ch">\n</span><span class="st">true:      </span><span class="sc">%s</span><span class="st">&#39;</span> <span class="op">%</span> (pred_name, true_name)</span>
<span id="cb7-122"><a href="MlAlgorithm.html#cb7-122"></a></span>
<span id="cb7-123"><a href="MlAlgorithm.html#cb7-123"></a>prediction_titles <span class="op">=</span> [title(y_pred, y_test, target_names, i)</span>
<span id="cb7-124"><a href="MlAlgorithm.html#cb7-124"></a>                     <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(y_pred.shape[<span class="dv">0</span>])]</span>
<span id="cb7-125"><a href="MlAlgorithm.html#cb7-125"></a></span>
<span id="cb7-126"><a href="MlAlgorithm.html#cb7-126"></a>plot_gallery(X_test, prediction_titles, h, w)</span>
<span id="cb7-127"><a href="MlAlgorithm.html#cb7-127"></a></span>
<span id="cb7-128"><a href="MlAlgorithm.html#cb7-128"></a><span class="co"># plot the gallery of the most significative eigenfaces</span></span>
<span id="cb7-129"><a href="MlAlgorithm.html#cb7-129"></a></span>
<span id="cb7-130"><a href="MlAlgorithm.html#cb7-130"></a>eigenface_titles <span class="op">=</span> [<span class="st">&quot;eigenface </span><span class="sc">%d</span><span class="st">&quot;</span> <span class="op">%</span> i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(eigenfaces.shape[<span class="dv">0</span>])]</span>
<span id="cb7-131"><a href="MlAlgorithm.html#cb7-131"></a>plot_gallery(eigenfaces, eigenface_titles, h, w)</span>
<span id="cb7-132"><a href="MlAlgorithm.html#cb7-132"></a></span>
<span id="cb7-133"><a href="MlAlgorithm.html#cb7-133"></a>plt.show()</span></code></pre></div>
<hr />
<div class="figure">
<img src="images/2880px-Kernel_Machine.svg.png" class="external" style="width:100.0%" alt="" />
<p class="caption">Figure from Alisneaky, svg version by User:Zirguezi [CC BY-SA (<a href="https://creativecommons.org/licenses/by-sa/4.0" class="uri">https://creativecommons.org/licenses/by-sa/4.0</a>)]</p>
</div>
</div>
<div id="svm-image-recognition" class="section level4">
<h4><span class="header-section-number">7.4.2.2</span> SVM Image recognition</h4>
<p>From the scikit-learn help page an example showing how the scikit-learn can be used to recognize images of hand-written digits.</p>
<p>The input data are hand written numbers</p>
<ul>
<li><p>Top: training data</p></li>
<li><p>Bottom: Prediction</p>
<p><img src="images/minstExample.png" style="width:60.0%" /></p>
<p>The confusion matrix is given below and shows for example that a true “3” is often mistaken as a “8” (see red circle)</p></li>
</ul>
<p><img src="images/ConfMatrixMinst.png" style="width:80.0%" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="MlAlgorithm.html#cb8-1"></a><span class="bu">print</span>(__doc__)</span>
<span id="cb8-2"><a href="MlAlgorithm.html#cb8-2"></a></span>
<span id="cb8-3"><a href="MlAlgorithm.html#cb8-3"></a><span class="co"># Author: Gael Varoquaux &lt;gael dot varoquaux at normalesup dot org&gt;</span></span>
<span id="cb8-4"><a href="MlAlgorithm.html#cb8-4"></a><span class="co"># License: BSD 3 clause</span></span>
<span id="cb8-5"><a href="MlAlgorithm.html#cb8-5"></a></span>
<span id="cb8-6"><a href="MlAlgorithm.html#cb8-6"></a><span class="co"># Standard scientific Python imports</span></span>
<span id="cb8-7"><a href="MlAlgorithm.html#cb8-7"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-8"><a href="MlAlgorithm.html#cb8-8"></a></span>
<span id="cb8-9"><a href="MlAlgorithm.html#cb8-9"></a><span class="co"># Import datasets, classifiers and performance metrics</span></span>
<span id="cb8-10"><a href="MlAlgorithm.html#cb8-10"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets, svm, metrics</span>
<span id="cb8-11"><a href="MlAlgorithm.html#cb8-11"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb8-12"><a href="MlAlgorithm.html#cb8-12"></a></span>
<span id="cb8-13"><a href="MlAlgorithm.html#cb8-13"></a><span class="co"># The digits dataset</span></span>
<span id="cb8-14"><a href="MlAlgorithm.html#cb8-14"></a>digits <span class="op">=</span> datasets.load_digits()</span>
<span id="cb8-15"><a href="MlAlgorithm.html#cb8-15"></a></span>
<span id="cb8-16"><a href="MlAlgorithm.html#cb8-16"></a><span class="co"># The data that we are interested in is made of 8x8 images of digits, let&#39;s</span></span>
<span id="cb8-17"><a href="MlAlgorithm.html#cb8-17"></a><span class="co"># have a look at the first 4 images, stored in the `images` attribute of the</span></span>
<span id="cb8-18"><a href="MlAlgorithm.html#cb8-18"></a><span class="co"># dataset.  If we were working from image files, we could load them using</span></span>
<span id="cb8-19"><a href="MlAlgorithm.html#cb8-19"></a><span class="co"># matplotlib.pyplot.imread.  Note that each image must have the same size. For these</span></span>
<span id="cb8-20"><a href="MlAlgorithm.html#cb8-20"></a><span class="co"># images, we know which digit they represent: it is given in the &#39;target&#39; of</span></span>
<span id="cb8-21"><a href="MlAlgorithm.html#cb8-21"></a><span class="co"># the dataset.</span></span>
<span id="cb8-22"><a href="MlAlgorithm.html#cb8-22"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb8-23"><a href="MlAlgorithm.html#cb8-23"></a>images_and_labels <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(digits.images, digits.target))</span>
<span id="cb8-24"><a href="MlAlgorithm.html#cb8-24"></a><span class="cf">for</span> ax, (image, label) <span class="kw">in</span> <span class="bu">zip</span>(axes[<span class="dv">0</span>, :], images_and_labels[:<span class="dv">4</span>]):</span>
<span id="cb8-25"><a href="MlAlgorithm.html#cb8-25"></a>    ax.set_axis_off()</span>
<span id="cb8-26"><a href="MlAlgorithm.html#cb8-26"></a>    ax.imshow(image, cmap<span class="op">=</span>plt.cm.gray_r, interpolation<span class="op">=</span><span class="st">&#39;nearest&#39;</span>)</span>
<span id="cb8-27"><a href="MlAlgorithm.html#cb8-27"></a>    ax.set_title(<span class="st">&#39;Training: </span><span class="sc">%i</span><span class="st">&#39;</span> <span class="op">%</span> label)</span>
<span id="cb8-28"><a href="MlAlgorithm.html#cb8-28"></a></span>
<span id="cb8-29"><a href="MlAlgorithm.html#cb8-29"></a><span class="co"># To apply a classifier on this data, we need to flatten the image, to</span></span>
<span id="cb8-30"><a href="MlAlgorithm.html#cb8-30"></a><span class="co"># turn the data in a (samples, feature) matrix:</span></span>
<span id="cb8-31"><a href="MlAlgorithm.html#cb8-31"></a>n_samples <span class="op">=</span> <span class="bu">len</span>(digits.images)</span>
<span id="cb8-32"><a href="MlAlgorithm.html#cb8-32"></a>data <span class="op">=</span> digits.images.reshape((n_samples, <span class="dv">-1</span>))</span>
<span id="cb8-33"><a href="MlAlgorithm.html#cb8-33"></a></span>
<span id="cb8-34"><a href="MlAlgorithm.html#cb8-34"></a><span class="co"># Create a classifier: a support vector classifier</span></span>
<span id="cb8-35"><a href="MlAlgorithm.html#cb8-35"></a>classifier <span class="op">=</span> svm.SVC(gamma<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb8-36"><a href="MlAlgorithm.html#cb8-36"></a></span>
<span id="cb8-37"><a href="MlAlgorithm.html#cb8-37"></a><span class="co"># Split data into train and test subsets</span></span>
<span id="cb8-38"><a href="MlAlgorithm.html#cb8-38"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb8-39"><a href="MlAlgorithm.html#cb8-39"></a>    data, digits.target, test_size<span class="op">=</span><span class="fl">0.5</span>, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-40"><a href="MlAlgorithm.html#cb8-40"></a></span>
<span id="cb8-41"><a href="MlAlgorithm.html#cb8-41"></a><span class="co"># We learn the digits on the first half of the digits</span></span>
<span id="cb8-42"><a href="MlAlgorithm.html#cb8-42"></a>classifier.fit(X_train, y_train)</span>
<span id="cb8-43"><a href="MlAlgorithm.html#cb8-43"></a></span>
<span id="cb8-44"><a href="MlAlgorithm.html#cb8-44"></a><span class="co"># Now predict the value of the digit on the second half:</span></span>
<span id="cb8-45"><a href="MlAlgorithm.html#cb8-45"></a>predicted <span class="op">=</span> classifier.predict(X_test)</span>
<span id="cb8-46"><a href="MlAlgorithm.html#cb8-46"></a></span>
<span id="cb8-47"><a href="MlAlgorithm.html#cb8-47"></a>images_and_predictions <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(digits.images[n_samples <span class="op">//</span> <span class="dv">2</span>:], predicted))</span>
<span id="cb8-48"><a href="MlAlgorithm.html#cb8-48"></a><span class="cf">for</span> ax, (image, prediction) <span class="kw">in</span> <span class="bu">zip</span>(axes[<span class="dv">1</span>, :], images_and_predictions[:<span class="dv">4</span>]):</span>
<span id="cb8-49"><a href="MlAlgorithm.html#cb8-49"></a>    ax.set_axis_off()</span>
<span id="cb8-50"><a href="MlAlgorithm.html#cb8-50"></a>    ax.imshow(image, cmap<span class="op">=</span>plt.cm.gray_r, interpolation<span class="op">=</span><span class="st">&#39;nearest&#39;</span>)</span>
<span id="cb8-51"><a href="MlAlgorithm.html#cb8-51"></a>    ax.set_title(<span class="st">&#39;Prediction: </span><span class="sc">%i</span><span class="st">&#39;</span> <span class="op">%</span> prediction)</span>
<span id="cb8-52"><a href="MlAlgorithm.html#cb8-52"></a></span>
<span id="cb8-53"><a href="MlAlgorithm.html#cb8-53"></a><span class="bu">print</span>(<span class="st">&quot;Classification report for classifier </span><span class="sc">%s</span><span class="st">:</span><span class="ch">\n</span><span class="sc">%s</span><span class="ch">\n</span><span class="st">&quot;</span></span>
<span id="cb8-54"><a href="MlAlgorithm.html#cb8-54"></a>      <span class="op">%</span> (classifier, metrics.classification_report(y_test, predicted)))</span>
<span id="cb8-55"><a href="MlAlgorithm.html#cb8-55"></a>disp <span class="op">=</span> metrics.plot_confusion_matrix(classifier, X_test, y_test)</span>
<span id="cb8-56"><a href="MlAlgorithm.html#cb8-56"></a>disp.figure_.suptitle(<span class="st">&quot;Confusion Matrix&quot;</span>)</span>
<span id="cb8-57"><a href="MlAlgorithm.html#cb8-57"></a><span class="bu">print</span>(<span class="st">&quot;Confusion matrix:</span><span class="ch">\n</span><span class="sc">%s</span><span class="st">&quot;</span> <span class="op">%</span> disp.confusion_matrix)</span>
<span id="cb8-58"><a href="MlAlgorithm.html#cb8-58"></a></span>
<span id="cb8-59"><a href="MlAlgorithm.html#cb8-59"></a>plt.show()</span></code></pre></div>
</div>
</div>
</div>
<div id="neural-networks" class="section level2">
<h2><span class="header-section-number">7.5</span> Neural networks</h2>
<p>non linear</p>
<p>activation</p>
<p>softmax
types of layers siehe keras
fully connected</p>
<div id="convolutional-neural-network-cnn-tbd" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Convolutional Neural Network (CNN) TBD</h3>
<p>A Convolutional Neural Network is an neural network are mainly used to analyze image and audio data.</p>
<p>The following explanation is based on <strong>The learning machine</strong> tutorial “Classification
Convolutional Neural Network (CNN)” <a href="https://www.thelearningmachine.ai/cnn" class="uri">https://www.thelearningmachine.ai/cnn</a></p>
<p>A classical CNN consists of</p>

<div class="rmdtip">
<ul>
<li>one or more convolutoional layers</li>
<li>one or more pooling layers</li>
<li>one or more fully connected layers</li>
</ul>
</div>

<p>A classical CNN is depicted in the image below</p>
<hr />
<div class="figure">
<img src="images/convNet.png" class="external" style="width:100.0%" alt="" />
<p class="caption">Figure from <a href="https://www.thelearningmachine.ai/cnn" class="uri">https://www.thelearningmachine.ai/cnn</a></p>
</div>
<hr />
<p>An image is an 3 dimensional array where the third dimension are for the colors red, green and blue, in case of an RGB image. An image can therefore be represented as shown below</p>
<hr />
<div class="figure">
<img src="images/rgbImage.png" class="external" style="width:60.0%" alt="" />
<p class="caption">Figure from <a href="https://www.thelearningmachine.ai/cnn" class="uri">https://www.thelearningmachine.ai/cnn</a></p>
</div>
<hr />
<p>To analyze an image the spatial relation between different pixels hold important information. Therefore it is beneficial to use an algorithm which looks not only at one pixel but also at the neighbouring pixels. One way of doing so is to slide an 2 dimensional array over the image array as can be seen below</p>
<hr />
<div class="figure">
<img src="images/conv1Layer.gif" class="external" style="width:60.0%" alt="" />
<p class="caption">Figure from <a href="https://www.thelearningmachine.ai/cnn" class="uri">https://www.thelearningmachine.ai/cnn</a></p>
</div>
<hr />
<p>The 2 dimensional array is called a <strong>kernel</strong> and is named depending on its dimensions. The kernel in the graph below is a <strong>“3 by 3 kernel”</strong>. Sliding the array across the image as gives a set of numbers as shown above. Those kernels can detect structures in images such as</p>
<ul>
<li>lines</li>
<li>boxes</li>
<li>circles</li>
</ul>
<p>and kernels in later layers in the CNN can detect more complex structures such as</p>
<ul>
<li>faces</li>
<li>wheels</li>
<li>trees</li>
</ul>
<hr />
<p><img src="images/kernelCnn.png" class="external" style="width:20.0%" /></p>
<hr />
<hr />
<div class="figure">
<img src="images/moveKernel.png" class="external" style="width:20.0%" alt="" />
<p class="caption">Figure from <a href="https://www.thelearningmachine.ai/cnn" class="uri">https://www.thelearningmachine.ai/cnn</a></p>
</div>
<hr />
<p>A kernel has the same depth of the input, in a case of an RGB image, the depth of the kernel is 3.
The output of the kernels is added, for each of the positions of the kernels there is one value at the output.</p>
<p>The movement across the image is based on the stride parameters for x and y direction. In the case below the stride is as follows</p>
<ul>
<li>stride x-direction = 1</li>
<li>stride y-direction = 1</li>
</ul>
<p>Depending on stride with and image dimension it might be necessary to apply padding, for details on padding see <a href="https://deepai.org/machine-learning-glossary-and-terms/padding">deepAi</a></p>
<hr />
<div class="figure">
<img src="images/convOperation.gif" class="external" style="width:100.0%" alt="" />
<p class="caption">Figure from <a href="https://www.thelearningmachine.ai/cnn" class="uri">https://www.thelearningmachine.ai/cnn</a></p>
</div>
<hr />
<div id="pooling-layer" class="section level4">
<h4><span class="header-section-number">7.5.1.1</span> Pooling layer</h4>
<p>The pooling layer reduces the dimension as shown below. There are different types of pooling layers</p>
<ul>
<li>max</li>
<li>average</li>
</ul>
<p>below the working mechanism for a max pooling layer is shown. The stride for x and y is one, the dimension of the 5 by 5 input is reduced to 3 by 3</p>
<div class="figure">
<img src="images/poolingOps.gif" class="external" style="width:80.0%" alt="" />
<p class="caption">Figure from <a href="https://www.thelearningmachine.ai/cnn" class="uri">https://www.thelearningmachine.ai/cnn</a></p>
</div>
<p>After one or more combination of convolutional and pooling layers one or more fully connected layers learn how to classify the image based on non-linear combinations of the high-level features learned by the previous layers.</p>
<p><img src="https://blogs.nvidia.com/wp-content/uploads/2018/09/autos-672x378.png" class="external" style="width:100.0%" alt="Figure from https://blogs.nvidia.com/wp-content/uploads/2018/09/autos-672x378.png" />
<a href="https://blogs.nvidia.com/wp-content/uploads/2018/09/autos-672x378.png" class="uri">https://blogs.nvidia.com/wp-content/uploads/2018/09/autos-672x378.png</a></p>
<p>The fully connected layer with the soft-max activation at the end gives the probability of each category, often as a result the three to five classes with the highest probability are reported.</p>
<ul>
<li>convolutional and pooling layers =&gt; high-level features</li>
<li>fully connected layers =&gt; combine non-linear high level features for classification</li>
</ul>
<div class="figure">
<img src="images/fcLayerCnn.png" class="external" style="width:100.0%" alt="" />
<p class="caption">Figure from <a href="https://www.thelearningmachine.ai/cnn" class="uri">https://www.thelearningmachine.ai/cnn</a></p>
</div>
<p>The operating principle of a CNN is shown below</p>
<hr />
<p><img src="images/cnnOperatingPrinciple.png" style="width:90.0%" /></p>
<hr />
</div>
</div>
<div id="rnn-tbd" class="section level3">
<h3><span class="header-section-number">7.5.2</span> RNN TBD</h3>
</div>
<div id="gans" class="section level3">
<h3><span class="header-section-number">7.5.3</span> GANs</h3>
<p>GANs from Scratch 1: A deep introduction. With code in PyTorch and TensorFlow</p>
<p><a href="https://medium.com/ai-society/gans-from-scratch-1-a-deep-introduction-with-code-in-pytorch-and-tensorflow-cb03cdcdba0f" class="uri">https://medium.com/ai-society/gans-from-scratch-1-a-deep-introduction-with-code-in-pytorch-and-tensorflow-cb03cdcdba0f</a></p>
<hr />
<p><img src="images/GanExamples.png"  style="width:100%;"></p>
<hr />
<p>credit of the image <span class="citation">(Zhu et al. <a href="#ref-CycleGAN2017" role="doc-biblioref">2017</a>)</span></p>
<p>Generative models learn the intrinsic distribution function of the input data p(x) (or p(x,y) if there are multiple targets/classes in the dataset), allowing them to generate both synthetic inputs x’ and outputs/targets y’, typically given some hidden parameters.</p>
<p>GANs they have proven to be really succesfull in modeling and generating high dimensional data, which is why they’ve become so popular. Nevertheless they are not the only types of Generative Models, others include Variational Autoencoders (VAEs) and pixelCNN/pixelRNN and real NVP. Each model has its own tradeoffs.</p>
<p>Some of the most relevant GAN pros and cons for the are:</p>
<ul>
<li><p>They currently generate the sharpest images</p></li>
<li><p>They are easy to train (since no statistical inference is required), and only back-propogation is needed to obtain gradients</p></li>
<li><p>GANs are difficult to optimize due to unstable training dynamics.</p></li>
<li><p>No statistical inference can be done with them (except here):
GANs belong to the class of direct implicit density models; they model p(x) without explicitly defining the p.d.f.</p></li>
</ul>
<p>A neural network G(z, θ₁)</p>
<p>Jupyter notebook on github <a href="https://github.com/diegoalejogm/gans/blob/master/1.%20Vanilla%20GAN%20PyTorch.ipynb" class="uri">https://github.com/diegoalejogm/gans/blob/master/1.%20Vanilla%20GAN%20PyTorch.ipynb</a></p>
</div>
</div>
<div id="a-gentle-introduction-to-cyclegan-for-image-translation" class="section level2">
<h2><span class="header-section-number">7.6</span> A Gentle Introduction to CycleGAN for Image Translation</h2>
<p><a href="https://machinelearningmastery.com/what-is-cyclegan/" class="uri">https://machinelearningmastery.com/what-is-cyclegan/</a></p>
<div id="examples-for-gans" class="section level3">
<h3><span class="header-section-number">7.6.1</span> Examples for GANs</h3>
<div id="gans-awesome-applications" class="section level4">
<h4><span class="header-section-number">7.6.1.1</span> gans-awesome-applications</h4>
<p>a list of plenty of applications can be found at <a href="https://github.com/nashory/gans-awesome-applications" class="uri">https://github.com/nashory/gans-awesome-applications</a></p>
</div>
</div>
</div>
<div id="software-that-can-generate-photos-from-paintings-turn-horses-into-zebras-perform-style-transfer-and-more." class="section level2">
<h2><span class="header-section-number">7.7</span> Software that can generate photos from paintings, turn horses into zebras, perform style transfer, and more.</h2>
<p>with software to do style transfer
<a href="https://github.com/junyanz/CycleGAN" class="uri">https://github.com/junyanz/CycleGAN</a>
### Pix2pix framework</p>
<p>Jupyter notebook for Colab
<a href="https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix/blob/master/pix2pix.ipynb" class="uri">https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix/blob/master/pix2pix.ipynb</a></p>
<p><a href="https://colab.research.google.com/github/tensorflow/models/blob/master/research/nst_blogpost/4_Neural_Style_Transfer_with_Eager_Execution.ipynb#scrollTo=aDyGj8DmXCJI" class="uri">https://colab.research.google.com/github/tensorflow/models/blob/master/research/nst_blogpost/4_Neural_Style_Transfer_with_Eager_Execution.ipynb#scrollTo=aDyGj8DmXCJI</a></p>
<p><img src="images/ColabPix2Pix.png"  style="width:30%;"></p>
</div>
<div id="transformers-tbd" class="section level2">
<h2><span class="header-section-number">7.8</span> Transformers TBD</h2>
<p>Attention Is All You Need <a href="https://arxiv.org/abs/1706.03762" class="uri">https://arxiv.org/abs/1706.03762</a></p>
<p><a href="https://jalammar.github.io/visualizing-neural-machine-translation-mechanics-of-seq2seq-models-with-attention/">Visualizing A Neural Machine Translation Model (Mechanics of Seq2seq Models With Attention)</a></p>
<p><a href="https://medium.com/inside-machine-learning/what-is-a-transformer-d07dd1fbec04">What is a Transformer?</a></p>
<p><a href="http://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a></p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-james2013introduction">
<p>James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2013. <em>An Introduction to Statistical Learning</em>. Vol. 112. Springer.</p>
</div>
<div id="ref-kuhn2013applied">
<p>Kuhn, Max, and Kjell Johnson. 2013. <em>Applied Predictive Modeling</em>. Vol. 26. Springer.</p>
</div>
<div id="ref-9781461471370">
<p>Tibshirani, Robert, G James, D Witten, and T Hastie. 2013. <em>An Introduction to Statistical Learning-with Applications in R</em>. New York, NY: Springer.</p>
</div>
<div id="ref-zhang2018exploring">
<p>Zhang, Zhongxing, Geert Mayer, Yves Dauvilliers, Giuseppe Plazzi, Fabio Pizza, Rolf Fronczek, Joan Santamaria, et al. 2018. “Exploring the Clinical Features of Narcolepsy Type 1 Versus Narcolepsy Type 2 from European Narcolepsy Network Database with Machine Learning.” <em>Scientific Reports</em> 8 (1): 1–11.</p>
</div>
<div id="ref-CycleGAN2017">
<p>Zhu, Jun-Yan, Taesung Park, Phillip Isola, and Alexei A Efros. 2017. “Unpaired Image-to-Image Translation Using Cycle-Consistent Adversarial Networks.” In <em>Computer Vision (Iccv), 2017 Ieee International Conference on</em>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="machineLearningClasses.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="food-for-the-algorithms-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MlOrienttionBookDown.pdf", "MlOrienttionBookDown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
